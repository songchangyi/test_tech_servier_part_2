[0m22:59:28.972160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d36a76950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d37907ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d37907490>]}


============================== 22:59:28.976196 | 54b7e6fb-9025-41b9-937d-41a5d4a310c4 ==============================
[0m22:59:28.976196 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:59:28.976928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m22:59:28.978224 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/csong/Desktop/test_tech_servier_part_2/dbt/profiles.yml
  
[0m22:59:28.979382 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.08411038, "process_in_blocks": "136", "process_kernel_time": 0.191763, "process_mem_max_rss": "86324", "process_out_blocks": "16", "process_user_time": 1.754129}
[0m22:59:28.980027 [debug] [MainThread]: Command `dbt seed` failed at 22:59:28.979819 after 0.08 seconds
[0m22:59:28.980522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d36a76950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d37906710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790d37906ad0>]}
[0m22:59:28.981137 [debug] [MainThread]: Flushing usage events
[0m22:59:29.437660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:20.590414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a4106920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a4fc63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a4fc7d30>]}


============================== 23:01:20.593336 | 56875b60-d573-4a01-a3a8-c49b4a7a50e0 ==============================
[0m23:01:20.593336 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:01:20.594255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:01:20.611738 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_servier", target "dev" invalid: 'schemas_and_paths' is a required property
[0m23:01:20.613687 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.088716626, "process_in_blocks": "0", "process_kernel_time": 0.184697, "process_mem_max_rss": "87476", "process_out_blocks": "16", "process_user_time": 1.681249}
[0m23:01:20.614448 [debug] [MainThread]: Command `dbt seed` failed at 23:01:20.614331 after 0.09 seconds
[0m23:01:20.615020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a4106920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a310b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8a31087f0>]}
[0m23:01:20.615534 [debug] [MainThread]: Flushing usage events
[0m23:01:21.064817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:27.967785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d7790769e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d779f04eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d779f07850>]}


============================== 23:02:27.970697 | 78b97f62-5644-43f3-9f8f-03bc4f5ca1cd ==============================
[0m23:02:27.970697 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:02:27.971573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:02:27.989134 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_servier", target "dev" invalid: 'schema_directory' is a required property
[0m23:02:27.990455 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.08662186, "process_in_blocks": "0", "process_kernel_time": 0.179744, "process_mem_max_rss": "87472", "process_out_blocks": "8", "process_user_time": 1.664632}
[0m23:02:27.991024 [debug] [MainThread]: Command `dbt seed` failed at 23:02:27.990915 after 0.09 seconds
[0m23:02:27.991620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d7790769e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d779f7f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d779f7e4a0>]}
[0m23:02:27.992255 [debug] [MainThread]: Flushing usage events
[0m23:02:28.437777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:17.504653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab73c2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab8287ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab8284e50>]}


============================== 23:03:17.507657 | cd520567-16b4-447c-8ba0-cd3e59d8bea0 ==============================
[0m23:03:17.507657 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:03:17.508491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:03:17.665846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab82d41f0>]}
[0m23:03:17.735934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab82d45b0>]}
[0m23:03:17.737025 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:03:17.932942 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:03:17.936479 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:03:17.937698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab8286e90>]}
[0m23:03:19.424809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab5d701c0>]}
[0m23:03:19.528069 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:03:19.530649 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:03:19.546536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab590a2c0>]}
[0m23:03:19.547271 [info ] [MainThread]: Found 2 models, 2 seeds, 2 sources, 413 macros
[0m23:03:19.547905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab5d30a30>]}
[0m23:03:19.549773 [info ] [MainThread]: 
[0m23:03:19.550400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:19.550918 [info ] [MainThread]: 
[0m23:03:19.552240 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:03:19.558600 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:03:19.605076 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:03:19.605885 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:03:19.606279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:19.607141 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:03:19.607625 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:03:19.608086 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:03:19.609293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:03:19.610964 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:03:19.611446 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:03:19.613277 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main_main'
[0m23:03:19.625539 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:03:19.628089 [debug] [ThreadPool]: On list_mydbt.db_main_main: BEGIN
[0m23:03:19.629060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:19.629757 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:03:19.630308 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:03:19.630798 [debug] [ThreadPool]: On list_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main_main"} */

        pragma database_list
    
[0m23:03:19.631411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:03:19.633102 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:03:19.633570 [debug] [ThreadPool]: On list_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main_main"} */

            SELECT null as database, null as name, null as schema, null as data_type WHERE 1=0
        
[0m23:03:19.634175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:03:19.636345 [debug] [ThreadPool]: On list_mydbt.db_main_main: ROLLBACK
[0m23:03:19.637243 [debug] [ThreadPool]: On list_mydbt.db_main_main: Close
[0m23:03:19.639497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db_main_main, now list_mydbt.db_main)
[0m23:03:19.643179 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:03:19.643685 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:03:19.644233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:19.644825 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:03:19.645362 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:03:19.645828 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:03:19.646466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:03:19.647901 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:03:19.648479 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:03:19.648981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:03:19.650242 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:03:19.650744 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:03:19.652046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab593e4d0>]}
[0m23:03:19.653193 [debug] [MainThread]: Using sqlite connection "master"
[0m23:03:19.653603 [debug] [MainThread]: On master: BEGIN
[0m23:03:19.654244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:19.654985 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:03:19.655501 [debug] [MainThread]: On master: COMMIT
[0m23:03:19.656105 [debug] [MainThread]: Using sqlite connection "master"
[0m23:03:19.656580 [debug] [MainThread]: On master: COMMIT
[0m23:03:19.657061 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:03:19.657681 [debug] [MainThread]: On master: Close
[0m23:03:19.666049 [debug] [Thread-1 (]: Began running node seed.dbt_servier.product_nomenclature
[0m23:03:19.666971 [info ] [Thread-1 (]: 1 of 2 START seed file main.product_nomenclature ............................... [RUN]
[0m23:03:19.668519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now seed.dbt_servier.product_nomenclature)
[0m23:03:19.669244 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.product_nomenclature
[0m23:03:19.669730 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.product_nomenclature
[0m23:03:19.705320 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:03:19.706100 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: BEGIN
[0m23:03:19.706639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:19.707642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:03:19.708362 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:03:19.708933 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.product_nomenclature"} */

    create table main."product_nomenclature" ("product_id" INT,"product_type" TEXT,"product_name" TEXT)
  
[0m23:03:19.709954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:03:19.732143 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:03:19.732741 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: 
            insert into main.product_nomenclature ("product_id", "product_type", "product_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?)
        ...
[0m23:03:19.733443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:03:19.740834 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.product_nomenclature"
[0m23:03:19.765616 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:03:19.766441 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:03:19.767047 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:03:19.771616 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:03:19.775750 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: Close
[0m23:03:19.778303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab4934820>]}
[0m23:03:19.779138 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main.product_nomenclature ........................... [[32mINSERT 4[0m in 0.11s]
[0m23:03:19.780084 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.product_nomenclature
[0m23:03:19.780687 [debug] [Thread-1 (]: Began running node seed.dbt_servier.transactions
[0m23:03:19.781634 [info ] [Thread-1 (]: 2 of 2 START seed file main.transactions ....................................... [RUN]
[0m23:03:19.782430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.product_nomenclature, now seed.dbt_servier.transactions)
[0m23:03:19.783097 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.transactions
[0m23:03:19.783890 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.transactions
[0m23:03:19.790131 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:03:19.790802 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: BEGIN
[0m23:03:19.791404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:19.792140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:03:19.792586 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:03:19.793267 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.transactions"} */

    create table main."transactions" ("date" TEXT,"order_id" INT,"client_id" INT,"prod_id" INT,"prod_price" REAL,"prod_qty" INT)
  
[0m23:03:19.794401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:03:19.804797 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:03:19.805612 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: 
            insert into main.transactions ("date", "order_id", "client_id", "prod_id", "prod_price", "prod_qty") values
            (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?)
        ...
[0m23:03:19.806333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:03:19.807418 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.transactions"
[0m23:03:19.810177 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:03:19.811154 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:03:19.811725 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:03:19.816164 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:03:19.817459 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: Close
[0m23:03:19.818822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd520567-16b4-447c-8ba0-cd3e59d8bea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab5ea4df0>]}
[0m23:03:19.819700 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file main.transactions ................................... [[32mINSERT 5[0m in 0.04s]
[0m23:03:19.820915 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.transactions
[0m23:03:19.825443 [debug] [MainThread]: Using sqlite connection "master"
[0m23:03:19.826244 [debug] [MainThread]: On master: BEGIN
[0m23:03:19.826707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:19.828332 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:03:19.829172 [debug] [MainThread]: On master: COMMIT
[0m23:03:19.829678 [debug] [MainThread]: Using sqlite connection "master"
[0m23:03:19.830277 [debug] [MainThread]: On master: COMMIT
[0m23:03:19.830890 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:03:19.831388 [debug] [MainThread]: On master: Close
[0m23:03:19.832145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:19.832652 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:03:19.833220 [debug] [MainThread]: Connection 'seed.dbt_servier.transactions' was properly closed.
[0m23:03:19.833760 [info ] [MainThread]: 
[0m23:03:19.835426 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:03:19.838747 [debug] [MainThread]: Command end result
[0m23:03:19.868782 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:03:19.871542 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:03:19.879199 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:03:19.879978 [info ] [MainThread]: 
[0m23:03:19.880837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:19.881623 [info ] [MainThread]: 
[0m23:03:19.882425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:03:19.883795 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.4424348, "process_in_blocks": "120", "process_kernel_time": 0.2753, "process_mem_max_rss": "109484", "process_out_blocks": "2552", "process_user_time": 3.794358}
[0m23:03:19.885021 [debug] [MainThread]: Command `dbt seed` succeeded at 23:03:19.884849 after 2.44 seconds
[0m23:03:19.885664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab73c2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab5d71cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711ab82d45b0>]}
[0m23:03:19.888463 [debug] [MainThread]: Flushing usage events
[0m23:03:20.348240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:49.019096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ce5b2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ce4f7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88cf473550>]}


============================== 23:18:49.022089 | 7751cda5-7e1f-4f04-b1a5-7d574bb520ae ==============================
[0m23:18:49.022089 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:18:49.023020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:49.176665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7751cda5-7e1f-4f04-b1a5-7d574bb520ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88cf632380>]}
[0m23:18:49.246003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7751cda5-7e1f-4f04-b1a5-7d574bb520ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88cf4c45b0>]}
[0m23:18:49.247268 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:18:49.374437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:18:49.523746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m23:18:49.524588 [debug] [MainThread]: Partial parsing: added file: dbt_servier://models/marts/product_ventes.sql
[0m23:18:49.525193 [debug] [MainThread]: Partial parsing: added file: dbt_servier://models/marts/client_product_ventes.sql
[0m23:18:49.845729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7751cda5-7e1f-4f04-b1a5-7d574bb520ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ccb60a60>]}
[0m23:18:49.948302 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:18:49.951184 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:18:49.964114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7751cda5-7e1f-4f04-b1a5-7d574bb520ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88cd372590>]}
[0m23:18:49.964802 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:18:49.965404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7751cda5-7e1f-4f04-b1a5-7d574bb520ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ccb63a30>]}
[0m23:18:49.967444 [info ] [MainThread]: 
[0m23:18:49.968089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:18:49.968572 [info ] [MainThread]: 
[0m23:18:49.969332 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:18:49.978754 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:18:50.042712 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:18:50.043406 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:18:50.043878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:50.045895 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:18:50.048239 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:18:50.048840 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:18:50.049710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:18:50.051324 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:18:50.051761 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:18:50.052620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db, now create_mydbt.db_main_main)
[0m23:18:50.053279 [debug] [ThreadPool]: Creating schema "database: "mydbt.db"
schema: "main_main"
"
[0m23:18:50.060219 [debug] [ThreadPool]: Using sqlite connection "create_mydbt.db_main_main"
[0m23:18:50.060705 [debug] [ThreadPool]: On create_mydbt.db_main_main: BEGIN
[0m23:18:50.061687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:50.062350 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:18:50.062930 [debug] [ThreadPool]: Using sqlite connection "create_mydbt.db_main_main"
[0m23:18:50.063478 [debug] [ThreadPool]: On create_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "create_mydbt.db_main_main"} */
attach database './schemas/main_main.db' as main_main
[0m23:18:50.064316 [debug] [ThreadPool]: On create_mydbt.db_main_main: ROLLBACK
[0m23:18:50.064859 [debug] [ThreadPool]: On create_mydbt.db_main_main: Close
[0m23:18:50.065336 [debug] [ThreadPool]: SQLite adapter: sqlite3 error: unable to open database: ./schemas/main_main.db
[0m23:18:50.065956 [debug] [ThreadPool]: SQLite adapter: Error running SQL: macro create_schema
[0m23:18:50.066389 [debug] [ThreadPool]: SQLite adapter: Rolling back transaction.
[0m23:18:50.067390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:50.067810 [debug] [MainThread]: Connection 'create_mydbt.db_main_main' was properly closed.
[0m23:18:50.068345 [info ] [MainThread]: 
[0m23:18:50.069069 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:18:50.069799 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error
    unable to open database: ./schemas/main_main.db
[0m23:18:50.071060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1173114, "process_in_blocks": "0", "process_kernel_time": 0.264336, "process_mem_max_rss": "106436", "process_out_blocks": "1664", "process_user_time": 2.619424}
[0m23:18:50.071642 [debug] [MainThread]: Command `dbt run` failed at 23:18:50.071529 after 1.12 seconds
[0m23:18:50.072233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ce5b2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88ccb63d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e88cc49f6d0>]}
[0m23:18:50.072782 [debug] [MainThread]: Flushing usage events
[0m23:18:50.542749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:44.251505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba75fda950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba76e9bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba76e98dc0>]}


============================== 23:23:44.254823 | 469a5f14-c4d4-4892-b3fa-87f7efb4c19e ==============================
[0m23:23:44.254823 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:23:44.255746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:23:44.410575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba76ee81f0>]}
[0m23:23:44.477088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba74e478e0>]}
[0m23:23:44.478158 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:23:44.633799 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:23:44.761455 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:23:44.762406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba75848850>]}
[0m23:23:46.164839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba745be800>]}
[0m23:23:46.284636 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:23:46.288275 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:23:46.304262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba745a5600>]}
[0m23:23:46.305466 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:23:46.306219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba764f7280>]}
[0m23:23:46.308477 [info ] [MainThread]: 
[0m23:23:46.309189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:46.309738 [info ] [MainThread]: 
[0m23:23:46.310643 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:23:46.318409 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:23:46.391404 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:23:46.393669 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:23:46.394412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:46.395479 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:46.398129 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:23:46.398650 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:23:46.399291 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.403058 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:23:46.405555 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:23:46.406696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db, now create_mydbt.db_main_main)
[0m23:23:46.407487 [debug] [ThreadPool]: Creating schema "database: "mydbt.db"
schema: "main_main"
"
[0m23:23:46.431340 [debug] [ThreadPool]: Using sqlite connection "create_mydbt.db_main_main"
[0m23:23:46.432038 [debug] [ThreadPool]: On create_mydbt.db_main_main: BEGIN
[0m23:23:46.432430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:46.433269 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:46.434095 [debug] [ThreadPool]: Using sqlite connection "create_mydbt.db_main_main"
[0m23:23:46.435686 [debug] [ThreadPool]: On create_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "create_mydbt.db_main_main"} */
attach database './/main_main.db' as main_main
[0m23:23:46.440285 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.441626 [debug] [ThreadPool]: On create_mydbt.db_main_main: COMMIT
[0m23:23:46.442177 [debug] [ThreadPool]: Using sqlite connection "create_mydbt.db_main_main"
[0m23:23:46.442575 [debug] [ThreadPool]: On create_mydbt.db_main_main: COMMIT
[0m23:23:46.443014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.447346 [debug] [ThreadPool]: On create_mydbt.db_main_main: Close
[0m23:23:46.449353 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main_main'
[0m23:23:46.473066 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:23:46.476029 [debug] [ThreadPool]: On list_mydbt.db_main_main: BEGIN
[0m23:23:46.476570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:46.477487 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:46.479816 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:23:46.480430 [debug] [ThreadPool]: On list_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main_main"} */

        pragma database_list
    
[0m23:23:46.480908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.484240 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main_main"
[0m23:23:46.487099 [debug] [ThreadPool]: On list_mydbt.db_main_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main_main' AS schema
                ,type as data_type
            FROM
                main_main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:23:46.487691 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.488880 [debug] [ThreadPool]: On list_mydbt.db_main_main: ROLLBACK
[0m23:23:46.489543 [debug] [ThreadPool]: On list_mydbt.db_main_main: Close
[0m23:23:46.490370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db_main_main, now list_mydbt.db_main)
[0m23:23:46.493492 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:23:46.494724 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:23:46.496075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:46.497092 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:23:46.497563 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:23:46.497989 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:23:46.498838 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.501113 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:23:46.502215 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:23:46.503046 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:23:46.504845 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:23:46.505440 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:23:46.508940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba752902b0>]}
[0m23:23:46.509669 [debug] [MainThread]: Using sqlite connection "master"
[0m23:23:46.510179 [debug] [MainThread]: On master: BEGIN
[0m23:23:46.510583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:46.513328 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m23:23:46.513878 [debug] [MainThread]: On master: COMMIT
[0m23:23:46.514289 [debug] [MainThread]: Using sqlite connection "master"
[0m23:23:46.514658 [debug] [MainThread]: On master: COMMIT
[0m23:23:46.517456 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:23:46.517883 [debug] [MainThread]: On master: Close
[0m23:23:46.527523 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:23:46.528399 [info ] [Thread-1 (]: 1 of 4 START sql view model main_main.client_product_ventes .................... [RUN]
[0m23:23:46.529034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:23:46.532272 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:23:46.547152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:23:46.548875 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:23:46.566342 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:23:46.567858 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:23:46.568567 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:23:46.569244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:46.570653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:23:46.571296 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:23:46.571841 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main_main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id
;;
[0m23:23:46.572878 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: ROLLBACK
[0m23:23:46.573539 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:23:46.574478 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: view "client_product_ventes" cannot reference objects in database main
[0m23:23:46.581392 [debug] [Thread-1 (]: Database Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  view "client_product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/client_product_ventes.sql
[0m23:23:46.583813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba76335f30>]}
[0m23:23:46.585468 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_main.client_product_ventes ........... [[31mERROR[0m in 0.05s]
[0m23:23:46.588804 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:23:46.589615 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:23:46.590503 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.client_product_ventes' to be skipped because of status 'error'.  Reason: Database Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  view "client_product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/client_product_ventes.sql.
[0m23:23:46.591317 [info ] [Thread-1 (]: 2 of 4 START sql view model main_main.product_ventes ........................... [RUN]
[0m23:23:46.594404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:23:46.594949 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:23:46.599296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:23:46.600181 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:23:46.604382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:23:46.605356 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:23:46.606223 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:23:46.606649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:46.607688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:23:46.608250 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:23:46.608709 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main_main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:23:46.609329 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: ROLLBACK
[0m23:23:46.609872 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:23:46.610383 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: view "product_ventes" cannot reference objects in database main
[0m23:23:46.611669 [debug] [Thread-1 (]: Database Error in model product_ventes (models/marts/product_ventes.sql)
  view "product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/product_ventes.sql
[0m23:23:46.612500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba7411b2e0>]}
[0m23:23:46.613511 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_main.product_ventes .................. [[31mERROR[0m in 0.02s]
[0m23:23:46.615082 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:23:46.615963 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:23:46.616733 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.product_ventes' to be skipped because of status 'error'.  Reason: Database Error in model product_ventes (models/marts/product_ventes.sql)
  view "product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/product_ventes.sql.
[0m23:23:46.617520 [info ] [Thread-1 (]: 3 of 4 START sql table model main_main.stg_product_nomenclature ................ [RUN]
[0m23:23:46.618908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:23:46.619400 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:23:46.626740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:23:46.630437 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:23:46.645664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:23:46.647327 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:23:46.647884 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:23:46.648651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:46.649591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:23:46.650127 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:23:46.650588 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main_main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM raw."product_nomenclature"

  
[0m23:23:46.651243 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: ROLLBACK
[0m23:23:46.651860 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:23:46.652664 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such table: raw.product_nomenclature
[0m23:23:46.655345 [debug] [Thread-1 (]: Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql
[0m23:23:46.656303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba76335f30>]}
[0m23:23:46.657296 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model main_main.stg_product_nomenclature ....... [[31mERROR[0m in 0.04s]
[0m23:23:46.658533 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:23:46.659287 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:23:46.660902 [info ] [Thread-1 (]: 4 of 4 START sql table model main_main.stg_transactions ........................ [RUN]
[0m23:23:46.659953 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.stg_product_nomenclature' to be skipped because of status 'error'.  Reason: Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql.
[0m23:23:46.662092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:23:46.662910 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:23:46.669301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:23:46.671401 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:23:46.676713 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:23:46.677748 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:23:46.678608 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:23:46.679149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:23:46.680308 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:23:46.680828 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:23:46.681447 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main_main."stg_transactions"
    as
        

SELECT
    *
FROM raw."transactions"

  
[0m23:23:46.682105 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: ROLLBACK
[0m23:23:46.682596 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:23:46.683830 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such table: raw.transactions
[0m23:23:46.685992 [debug] [Thread-1 (]: Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql
[0m23:23:46.687761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469a5f14-c4d4-4892-b3fa-87f7efb4c19e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba6f3a7dc0>]}
[0m23:23:46.689273 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model main_main.stg_transactions ............... [[31mERROR[0m in 0.03s]
[0m23:23:46.690536 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:23:46.692088 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql.
[0m23:23:46.693750 [debug] [MainThread]: Using sqlite connection "master"
[0m23:23:46.694406 [debug] [MainThread]: On master: BEGIN
[0m23:23:46.694936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:46.696965 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:23:46.699504 [debug] [MainThread]: On master: COMMIT
[0m23:23:46.700815 [debug] [MainThread]: Using sqlite connection "master"
[0m23:23:46.701410 [debug] [MainThread]: On master: COMMIT
[0m23:23:46.702324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:23:46.702901 [debug] [MainThread]: On master: Close
[0m23:23:46.704302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:46.704780 [debug] [MainThread]: Connection 'create_mydbt.db_main_main' was properly closed.
[0m23:23:46.705437 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:23:46.706185 [info ] [MainThread]: 
[0m23:23:46.707219 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m23:23:46.709279 [debug] [MainThread]: Command end result
[0m23:23:46.742148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:23:46.745517 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:23:46.760238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:23:46.761145 [info ] [MainThread]: 
[0m23:23:46.762267 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m23:23:46.763241 [info ] [MainThread]: 
[0m23:23:46.765401 [error] [MainThread]:   Database Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  view "client_product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/client_product_ventes.sql
[0m23:23:46.767256 [info ] [MainThread]: 
[0m23:23:46.768729 [error] [MainThread]:   Database Error in model product_ventes (models/marts/product_ventes.sql)
  view "product_ventes" cannot reference objects in database main
  compiled code at target/run/dbt_servier/models/marts/product_ventes.sql
[0m23:23:46.770722 [info ] [MainThread]: 
[0m23:23:46.771732 [error] [MainThread]:   Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql
[0m23:23:46.772619 [info ] [MainThread]: 
[0m23:23:46.774088 [error] [MainThread]:   Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql
[0m23:23:46.775312 [info ] [MainThread]: 
[0m23:23:46.776256 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m23:23:46.777814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6024106, "process_in_blocks": "56", "process_kernel_time": 0.297594, "process_mem_max_rss": "111156", "process_out_blocks": "2592", "process_user_time": 3.841858}
[0m23:23:46.779380 [debug] [MainThread]: Command `dbt run` failed at 23:23:46.779222 after 2.60 seconds
[0m23:23:46.780372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba75fda950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba766a4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba745a6bf0>]}
[0m23:23:46.780916 [debug] [MainThread]: Flushing usage events
[0m23:23:47.240906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:10.110067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2356f29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2365b0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2365b3850>]}


============================== 23:26:10.113985 | 641347a6-726f-473a-b848-1f3969f0c489 ==============================
[0m23:26:10.113985 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:26:10.114953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:10.133403 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_servier", target "dev" invalid: 'schemas_and_paths' is a required property
[0m23:26:10.134862 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.116201885, "process_in_blocks": "0", "process_kernel_time": 0.180767, "process_mem_max_rss": "87464", "process_out_blocks": "16", "process_user_time": 1.7867}
[0m23:26:10.135986 [debug] [MainThread]: Command `dbt seed` failed at 23:26:10.135822 after 0.12 seconds
[0m23:26:10.137172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2356f29e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2366275e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c2366264a0>]}
[0m23:26:10.138436 [debug] [MainThread]: Flushing usage events
[0m23:26:10.593287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:36.295058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c057a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c140a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c140bd30>]}


============================== 23:27:36.298005 | 7c72854a-2f42-46b4-9957-9773059a599e ==============================
[0m23:27:36.298005 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:27:36.298844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m23:27:36.604542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c15ea320>]}
[0m23:27:36.673559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758bf977a00>]}
[0m23:27:36.674589 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:27:36.811256 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:27:36.935302 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:27:36.936039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758bfdc8820>]}
[0m23:27:38.360250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758be7867d0>]}
[0m23:27:38.473914 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:27:38.476827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:27:38.490494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758bf0d76d0>]}
[0m23:27:38.491240 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:27:38.491802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758bef5edd0>]}
[0m23:27:38.493833 [info ] [MainThread]: 
[0m23:27:38.494378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:38.494957 [info ] [MainThread]: 
[0m23:27:38.495615 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:27:38.504301 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:27:38.560689 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:27:38.561558 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:27:38.562447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:38.564739 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:27:38.565758 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:27:38.566402 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:27:38.566875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:38.568504 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:27:38.569537 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:27:38.571617 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:27:38.582901 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:38.583688 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:27:38.584255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:38.585648 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:27:38.587339 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:38.590077 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:27:38.590936 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:38.592780 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:38.593514 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:27:38.594113 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:38.595748 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:27:38.596570 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:27:38.598523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758be603640>]}
[0m23:27:38.599270 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:38.599737 [debug] [MainThread]: On master: BEGIN
[0m23:27:38.600324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:38.601356 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:27:38.602020 [debug] [MainThread]: On master: COMMIT
[0m23:27:38.603569 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:38.606499 [debug] [MainThread]: On master: COMMIT
[0m23:27:38.607265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:27:38.607756 [debug] [MainThread]: On master: Close
[0m23:27:38.611284 [debug] [Thread-1 (]: Began running node seed.dbt_servier.product_nomenclature
[0m23:27:38.612362 [info ] [Thread-1 (]: 1 of 2 START seed file main.product_nomenclature ............................... [RUN]
[0m23:27:38.614543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now seed.dbt_servier.product_nomenclature)
[0m23:27:38.615148 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.product_nomenclature
[0m23:27:38.615783 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.product_nomenclature
[0m23:27:38.652247 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:27:38.653395 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: BEGIN
[0m23:27:38.653847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:38.655044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:27:38.655620 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:27:38.658548 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.product_nomenclature"} */
delete from "main"."product_nomenclature"
[0m23:27:38.659371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:27:38.692473 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:27:38.693351 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: 
            insert into main.product_nomenclature ("product_id", "product_type", "product_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?)
        ...
[0m23:27:38.693949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:27:38.703072 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.product_nomenclature"
[0m23:27:38.728969 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:27:38.729779 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:27:38.730452 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:27:38.733241 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:27:38.735626 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: Close
[0m23:27:38.738208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758be769ed0>]}
[0m23:27:38.738912 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main.product_nomenclature ........................... [[32mINSERT 4[0m in 0.12s]
[0m23:27:38.739823 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.product_nomenclature
[0m23:27:38.740439 [debug] [Thread-1 (]: Began running node seed.dbt_servier.transactions
[0m23:27:38.741166 [info ] [Thread-1 (]: 2 of 2 START seed file main.transactions ....................................... [RUN]
[0m23:27:38.741841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.product_nomenclature, now seed.dbt_servier.transactions)
[0m23:27:38.742444 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.transactions
[0m23:27:38.742947 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.transactions
[0m23:27:38.750982 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:27:38.751700 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: BEGIN
[0m23:27:38.752130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:38.753583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:27:38.754200 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:27:38.754689 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.transactions"} */
delete from "main"."transactions"
[0m23:27:38.755409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:27:38.767958 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:27:38.768723 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: 
            insert into main.transactions ("date", "order_id", "client_id", "prod_id", "prod_price", "prod_qty") values
            (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?)
        ...
[0m23:27:38.769834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:27:38.770800 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.transactions"
[0m23:27:38.773532 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:27:38.774215 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:27:38.774689 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:27:38.781504 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:27:38.783463 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: Close
[0m23:27:38.784469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c72854a-2f42-46b4-9957-9773059a599e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758be769ed0>]}
[0m23:27:38.785196 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file main.transactions ................................... [[32mINSERT 5[0m in 0.04s]
[0m23:27:38.786423 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.transactions
[0m23:27:38.790439 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:38.791255 [debug] [MainThread]: On master: BEGIN
[0m23:27:38.791743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:38.793655 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:27:38.795745 [debug] [MainThread]: On master: COMMIT
[0m23:27:38.796656 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:38.799423 [debug] [MainThread]: On master: COMMIT
[0m23:27:38.799945 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:27:38.800352 [debug] [MainThread]: On master: Close
[0m23:27:38.801115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:38.801537 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:27:38.802125 [debug] [MainThread]: Connection 'seed.dbt_servier.transactions' was properly closed.
[0m23:27:38.803209 [info ] [MainThread]: 
[0m23:27:38.804042 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:27:38.806016 [debug] [MainThread]: Command end result
[0m23:27:38.838955 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:27:38.841239 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:27:38.849537 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:27:38.850181 [info ] [MainThread]: 
[0m23:27:38.851440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:38.852965 [info ] [MainThread]: 
[0m23:27:38.855379 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:27:38.858161 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.6275742, "process_in_blocks": "0", "process_kernel_time": 0.333348, "process_mem_max_rss": "111024", "process_out_blocks": "2608", "process_user_time": 4.112293}
[0m23:27:38.858882 [debug] [MainThread]: Command `dbt seed` succeeded at 23:27:38.858692 after 2.63 seconds
[0m23:27:38.859504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c057a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758bd91c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7758c15ea320>]}
[0m23:27:38.860191 [debug] [MainThread]: Flushing usage events
[0m23:27:39.321952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:43.525490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651faa728f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fb9465f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fb945cc0>]}


============================== 23:27:43.528790 | 8c31d4a0-cb01-48a4-b2fd-86f24de44c70 ==============================
[0m23:27:43.528790 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:27:43.529708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:27:43.883408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f9e71240>]}
[0m23:27:43.962508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fb9387c0>]}
[0m23:27:43.963644 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:27:44.105994 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:27:44.256034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:44.256710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:44.317188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f9572770>]}
[0m23:27:44.419674 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:27:44.422620 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:27:44.434489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f95a6110>]}
[0m23:27:44.435676 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:27:44.436294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f94fa710>]}
[0m23:27:44.438454 [info ] [MainThread]: 
[0m23:27:44.439083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:44.439564 [info ] [MainThread]: 
[0m23:27:44.440318 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:27:44.447378 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:27:44.495640 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:27:44.496667 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:27:44.497255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:44.498469 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:27:44.499100 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:27:44.501187 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:27:44.502313 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:44.503902 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:27:44.504421 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:27:44.506587 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:27:44.523440 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:44.524300 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:27:44.525546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:44.527801 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:27:44.528417 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:44.529002 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:27:44.529586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:44.531433 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:27:44.531937 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:27:44.532639 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:27:44.535245 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:27:44.537227 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:27:44.538914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fb944820>]}
[0m23:27:44.539500 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:44.539986 [debug] [MainThread]: On master: BEGIN
[0m23:27:44.540361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:44.541352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:27:44.541817 [debug] [MainThread]: On master: COMMIT
[0m23:27:44.542426 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:44.542863 [debug] [MainThread]: On master: COMMIT
[0m23:27:44.543427 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:27:44.543875 [debug] [MainThread]: On master: Close
[0m23:27:44.546436 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:27:44.547403 [info ] [Thread-1 (]: 1 of 4 START sql view model main.client_product_ventes ......................... [RUN]
[0m23:27:44.548213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:27:44.548738 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:27:44.566246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:27:44.569350 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:27:44.595102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:27:44.596346 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:27:44.596878 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:27:44.597445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:44.598560 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:27:44.599327 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:27:44.599831 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id
;;
[0m23:27:44.600484 [debug] [Thread-1 (]: SQLite adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id
;;
[0m23:27:44.601089 [debug] [Thread-1 (]: SQLite adapter: Rolling back transaction.
[0m23:27:44.602045 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: ROLLBACK
[0m23:27:44.602533 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:27:44.606019 [debug] [Thread-1 (]: Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time.
[0m23:27:44.611754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f87812d0>]}
[0m23:27:44.612982 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.client_product_ventes ................ [[31mERROR[0m in 0.06s]
[0m23:27:44.614307 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:27:44.614962 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:27:44.616658 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.client_product_ventes' to be skipped because of status 'error'.  Reason: Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time..
[0m23:27:44.615584 [info ] [Thread-1 (]: 2 of 4 START sql view model main.product_ventes ................................ [RUN]
[0m23:27:44.619038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:27:44.619606 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:27:44.624501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:27:44.625664 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:27:44.630797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:27:44.632778 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:27:44.633547 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:27:44.634050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:44.636514 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:27:44.638371 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:27:44.639370 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:27:44.641557 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:27:44.650659 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:27:44.651860 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:27:44.652523 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:27:44.655278 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:27:44.658783 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:27:44.659820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fadd1690>]}
[0m23:27:44.660843 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.product_ventes ........................... [[32mOK[0m in 0.04s]
[0m23:27:44.662061 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:27:44.662944 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:27:44.663913 [info ] [Thread-1 (]: 3 of 4 START sql table model main.stg_product_nomenclature ..................... [RUN]
[0m23:27:44.665031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:27:44.665595 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:27:44.673253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:27:44.674430 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:27:44.694965 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:27:44.696449 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:27:44.697141 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:27:44.697803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:44.698866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:27:44.699464 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:27:44.699996 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM raw."product_nomenclature"

  
[0m23:27:44.700634 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: ROLLBACK
[0m23:27:44.701628 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:27:44.702295 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such table: raw.product_nomenclature
[0m23:27:44.703718 [debug] [Thread-1 (]: Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql
[0m23:27:44.704724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651fadd1690>]}
[0m23:27:44.705824 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model main.stg_product_nomenclature ............ [[31mERROR[0m in 0.04s]
[0m23:27:44.707540 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:27:44.708396 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:27:44.709238 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.stg_product_nomenclature' to be skipped because of status 'error'.  Reason: Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql.
[0m23:27:44.710383 [info ] [Thread-1 (]: 4 of 4 START sql table model main.stg_transactions ............................. [RUN]
[0m23:27:44.711528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:27:44.714564 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:27:44.723557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:27:44.725015 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:27:44.732085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:27:44.735655 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:27:44.736379 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:27:44.736875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:27:44.737992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:27:44.738529 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:27:44.739174 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM raw."transactions"

  
[0m23:27:44.739746 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: ROLLBACK
[0m23:27:44.740355 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:27:44.740858 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such table: raw.transactions
[0m23:27:44.742316 [debug] [Thread-1 (]: Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql
[0m23:27:44.742987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c31d4a0-cb01-48a4-b2fd-86f24de44c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f873cdf0>]}
[0m23:27:44.743841 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model main.stg_transactions .................... [[31mERROR[0m in 0.03s]
[0m23:27:44.745144 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:27:44.747236 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql.
[0m23:27:44.752683 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:44.754394 [debug] [MainThread]: On master: BEGIN
[0m23:27:44.755016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:44.755970 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:27:44.756570 [debug] [MainThread]: On master: COMMIT
[0m23:27:44.757072 [debug] [MainThread]: Using sqlite connection "master"
[0m23:27:44.757648 [debug] [MainThread]: On master: COMMIT
[0m23:27:44.758220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:27:44.758668 [debug] [MainThread]: On master: Close
[0m23:27:44.759460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:44.759895 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:27:44.760407 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:27:44.761032 [info ] [MainThread]: 
[0m23:27:44.761586 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m23:27:44.763350 [debug] [MainThread]: Command end result
[0m23:27:44.806892 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:27:44.809202 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:27:44.819857 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:27:44.820582 [info ] [MainThread]: 
[0m23:27:44.821278 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:27:44.821779 [info ] [MainThread]: 
[0m23:27:44.822463 [error] [MainThread]:   Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time.
[0m23:27:44.825270 [info ] [MainThread]: 
[0m23:27:44.826361 [error] [MainThread]:   Database Error in model stg_product_nomenclature (models/staging/stg_product_nomenclature.sql)
  no such table: raw.product_nomenclature
  compiled code at target/run/dbt_servier/models/staging/stg_product_nomenclature.sql
[0m23:27:44.827373 [info ] [MainThread]: 
[0m23:27:44.830403 [error] [MainThread]:   Database Error in model stg_transactions (models/staging/stg_transactions.sql)
  no such table: raw.transactions
  compiled code at target/run/dbt_servier/models/staging/stg_transactions.sql
[0m23:27:44.832544 [info ] [MainThread]: 
[0m23:27:44.833927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m23:27:44.836386 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3755623, "process_in_blocks": "0", "process_kernel_time": 0.264833, "process_mem_max_rss": "104492", "process_out_blocks": "1792", "process_user_time": 2.722008}
[0m23:27:44.837270 [debug] [MainThread]: Command `dbt run` failed at 23:27:44.837116 after 1.38 seconds
[0m23:27:44.837897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651faa728f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f95a41c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651f95a7d30>]}
[0m23:27:44.838641 [debug] [MainThread]: Flushing usage events
[0m23:27:45.296369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:52.298372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dfe4fa980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dfe43bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dff3bb550>]}


============================== 23:29:52.301917 | b39edc23-f4c1-4be4-94c6-abc10357f131 ==============================
[0m23:29:52.301917 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:29:52.302742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:52.471262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b39edc23-f4c1-4be4-94c6-abc10357f131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dff57a380>]}
[0m23:29:52.537598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b39edc23-f4c1-4be4-94c6-abc10357f131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dff40c5b0>]}
[0m23:29:52.538699 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:29:52.670060 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:29:52.817639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:52.818708 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/staging/source.yml
[0m23:29:53.167904 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_servier.stg_transactions' (models/staging/stg_transactions.sql) depends on a source named 'raw.transactions' which was not found
[0m23:29:53.169843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9401611, "process_in_blocks": "0", "process_kernel_time": 0.243196, "process_mem_max_rss": "100024", "process_out_blocks": "16", "process_user_time": 2.430976}
[0m23:29:53.170510 [debug] [MainThread]: Command `dbt run` failed at 23:29:53.170398 after 0.94 seconds
[0m23:29:53.171006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dfe4fa980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dfd0846a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729dfd086110>]}
[0m23:29:53.171611 [debug] [MainThread]: Flushing usage events
[0m23:29:53.629563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:25.689812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736f06980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736e4bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3737dc7550>]}


============================== 23:30:25.692775 | 5c2a4467-37f9-4637-ae70-64f12b0f9cc6 ==============================
[0m23:30:25.692775 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:30:25.694201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:30:25.851740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3737f86380>]}
[0m23:30:25.918486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3737e185b0>]}
[0m23:30:25.919516 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:30:26.046938 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:30:26.194640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:30:26.195964 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/staging/source.yml
[0m23:30:26.196548 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/staging/stg_product_nomenclature.sql
[0m23:30:26.197138 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/staging/stg_transactions.sql
[0m23:30:26.637175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3735144790>]}
[0m23:30:26.735811 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:30:26.738593 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:30:26.751277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37351455d0>]}
[0m23:30:26.752114 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:30:26.752650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3735145540>]}
[0m23:30:26.754660 [info ] [MainThread]: 
[0m23:30:26.755400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:26.755907 [info ] [MainThread]: 
[0m23:30:26.756703 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:30:26.765002 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:30:26.815840 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:30:26.816561 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:30:26.817265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:26.818419 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:30:26.818868 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:30:26.819393 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:30:26.819844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:30:26.821664 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:30:26.822264 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:30:26.824283 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:30:26.896803 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:30:26.897455 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:30:26.898036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:26.898990 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:30:26.899446 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:30:26.900007 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:30:26.900477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:30:26.902144 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:30:26.902627 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:30:26.903244 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:30:26.904565 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:30:26.905103 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:30:26.906537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c373552d330>]}
[0m23:30:26.907219 [debug] [MainThread]: Using sqlite connection "master"
[0m23:30:26.907647 [debug] [MainThread]: On master: BEGIN
[0m23:30:26.908144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:26.909119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:30:26.910112 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.910561 [debug] [MainThread]: Using sqlite connection "master"
[0m23:30:26.910977 [debug] [MainThread]: On master: COMMIT
[0m23:30:26.911513 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:30:26.911976 [debug] [MainThread]: On master: Close
[0m23:30:26.915256 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:30:26.915937 [info ] [Thread-1 (]: 1 of 4 START sql view model main.client_product_ventes ......................... [RUN]
[0m23:30:26.917039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:30:26.917632 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:30:26.933575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:30:26.934551 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:30:26.951885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:30:26.957538 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:30:26.958377 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:30:26.958860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:26.963764 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:30:26.964530 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:30:26.967135 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id
;;
[0m23:30:26.972311 [debug] [Thread-1 (]: SQLite adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id
;;
[0m23:30:26.975522 [debug] [Thread-1 (]: SQLite adapter: Rolling back transaction.
[0m23:30:26.976698 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: ROLLBACK
[0m23:30:26.979162 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:30:26.987841 [debug] [Thread-1 (]: Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time.
[0m23:30:26.997929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c373552d510>]}
[0m23:30:26.999305 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.client_product_ventes ................ [[31mERROR[0m in 0.08s]
[0m23:30:27.004918 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:30:27.005628 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:30:27.011026 [debug] [Thread-4 (]: Marking all children of 'model.dbt_servier.client_product_ventes' to be skipped because of status 'error'.  Reason: Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time..
[0m23:30:27.010131 [info ] [Thread-1 (]: 2 of 4 START sql view model main.product_ventes ................................ [RUN]
[0m23:30:27.015411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:30:27.016086 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:30:27.030173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:30:27.034163 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:30:27.061228 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:30:27.065958 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */
drop view if exists "main"."product_ventes"
[0m23:30:27.066787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:27.078176 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m23:30:27.082796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:30:27.087638 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:30:27.090159 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:30:27.090754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:30:27.094760 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:30:27.098061 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:30:27.101433 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:30:27.114026 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:30:27.114948 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:30:27.115438 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:30:27.117674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:30:27.124174 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:30:27.126675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736d010f0>]}
[0m23:30:27.129691 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.product_ventes ........................... [[32mOK[0m in 0.11s]
[0m23:30:27.134536 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:30:27.135152 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:30:27.135741 [info ] [Thread-1 (]: 3 of 4 START sql table model main.stg_product_nomenclature ..................... [RUN]
[0m23:30:27.141470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:30:27.145395 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:30:27.177396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:30:27.182401 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:30:27.201504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:30:27.203234 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:30:27.204456 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:30:27.206119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:27.207234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:30:27.207704 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:30:27.212902 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m23:30:27.216374 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:30:27.222160 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:30:27.222896 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:30:27.223500 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:30:27.230254 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:30:27.231581 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:30:27.237413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37380844c0>]}
[0m23:30:27.241700 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.stg_product_nomenclature ................ [[32mOK[0m in 0.10s]
[0m23:30:27.245773 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:30:27.247151 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:30:27.248454 [info ] [Thread-1 (]: 4 of 4 START sql table model main.stg_transactions ............................. [RUN]
[0m23:30:27.249728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:30:27.250707 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:30:27.255698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:30:27.256951 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:30:27.261113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:30:27.262415 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:30:27.263011 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:30:27.263618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:27.264703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:30:27.265327 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:30:27.265843 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m23:30:27.266889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:30:27.268912 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:30:27.269628 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:30:27.270333 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:30:27.276461 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:30:27.278009 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:30:27.279576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c2a4467-37f9-4637-ae70-64f12b0f9cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3735557310>]}
[0m23:30:27.282230 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.03s]
[0m23:30:27.284108 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:30:27.285813 [debug] [MainThread]: Using sqlite connection "master"
[0m23:30:27.286572 [debug] [MainThread]: On master: BEGIN
[0m23:30:27.287026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:27.288668 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:30:27.289339 [debug] [MainThread]: On master: COMMIT
[0m23:30:27.290075 [debug] [MainThread]: Using sqlite connection "master"
[0m23:30:27.290559 [debug] [MainThread]: On master: COMMIT
[0m23:30:27.291185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:30:27.291668 [debug] [MainThread]: On master: Close
[0m23:30:27.292505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:27.293463 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:30:27.293895 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:30:27.294544 [info ] [MainThread]: 
[0m23:30:27.295100 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m23:30:27.296828 [debug] [MainThread]: Command end result
[0m23:30:27.333254 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:30:27.335439 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:30:27.351305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:30:27.352066 [info ] [MainThread]: 
[0m23:30:27.352910 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:30:27.355688 [info ] [MainThread]: 
[0m23:30:27.356645 [error] [MainThread]:   Runtime Error in model client_product_ventes (models/marts/client_product_ventes.sql)
  You can only execute one statement at a time.
[0m23:30:27.360118 [info ] [MainThread]: 
[0m23:30:27.361648 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:30:27.364490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7408558, "process_in_blocks": "0", "process_kernel_time": 0.274721, "process_mem_max_rss": "109484", "process_out_blocks": "2736", "process_user_time": 3.009909}
[0m23:30:27.366536 [debug] [MainThread]: Command `dbt run` failed at 23:30:27.366166 after 1.74 seconds
[0m23:30:27.367934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736f06980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736775420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3736776c50>]}
[0m23:30:27.368584 [debug] [MainThread]: Flushing usage events
[0m23:30:27.855035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:35.577383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339f676950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b33a0506680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b33a05063e0>]}


============================== 23:33:35.580317 | ce3f8751-c12c-4097-9215-c72eb1d4e8d1 ==============================
[0m23:33:35.580317 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:33:35.581166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:33:35.859158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b33a0550250>]}
[0m23:33:35.932005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339e4216c0>]}
[0m23:33:35.933093 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:33:36.076762 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:33:36.228116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:36.228879 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/marts/client_product_ventes.sql
[0m23:33:36.541029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339def0d00>]}
[0m23:33:36.643638 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:33:36.646673 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:33:36.659135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339e0f3400>]}
[0m23:33:36.659946 [info ] [MainThread]: Found 4 models, 2 seeds, 2 sources, 413 macros
[0m23:33:36.660459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339e0a0ac0>]}
[0m23:33:36.662519 [info ] [MainThread]: 
[0m23:33:36.663205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:36.663701 [info ] [MainThread]: 
[0m23:33:36.664457 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:33:36.673959 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:33:36.726328 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:33:36.727401 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:33:36.727974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:36.731156 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:33:36.731932 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:33:36.732529 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:33:36.733349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:33:36.736157 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:33:36.736896 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:33:36.740529 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:33:36.754671 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:33:36.755806 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:33:36.756353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:36.757542 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:33:36.758333 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:33:36.761357 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:33:36.761934 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:33:36.763712 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:33:36.764441 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:33:36.764949 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:33:36.766428 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:33:36.766959 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:33:36.769260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b33a053f310>]}
[0m23:33:36.769964 [debug] [MainThread]: Using sqlite connection "master"
[0m23:33:36.770390 [debug] [MainThread]: On master: BEGIN
[0m23:33:36.770792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:36.771881 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:33:36.772451 [debug] [MainThread]: On master: COMMIT
[0m23:33:36.772900 [debug] [MainThread]: Using sqlite connection "master"
[0m23:33:36.773423 [debug] [MainThread]: On master: COMMIT
[0m23:33:36.773857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:33:36.774387 [debug] [MainThread]: On master: Close
[0m23:33:36.777331 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:33:36.778118 [info ] [Thread-1 (]: 1 of 4 START sql view model main.client_product_ventes ......................... [RUN]
[0m23:33:36.779644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:33:36.780331 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:33:36.794800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:33:36.796072 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:33:36.816275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:33:36.819432 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:33:36.820036 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:33:36.820647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:36.823572 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:33:36.824339 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:33:36.824903 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id;
[0m23:33:36.826077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:36.832717 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:33:36.835249 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:33:36.836380 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:33:36.842140 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:33:36.846533 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:33:36.849707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339cca1420>]}
[0m23:33:36.850984 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.client_product_ventes .................... [[32mOK[0m in 0.07s]
[0m23:33:36.853520 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:33:36.854389 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:33:36.855956 [info ] [Thread-1 (]: 2 of 4 START sql view model main.product_ventes ................................ [RUN]
[0m23:33:36.856812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:33:36.857496 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:33:36.861500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:33:36.862740 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:33:36.874520 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:33:36.875531 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */
drop view if exists "main"."product_ventes"
[0m23:33:36.876433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:36.881328 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:33:36.883318 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:33:36.885097 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:33:36.885743 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:33:36.886435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:36.886967 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:33:36.887599 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:33:36.888681 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:36.890385 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:33:36.891182 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:33:36.891715 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:33:36.894386 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:33:36.895598 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:33:36.896719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339f9d5f30>]}
[0m23:33:36.897670 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.product_ventes ........................... [[32mOK[0m in 0.04s]
[0m23:33:36.898819 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:33:36.899574 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:33:36.900483 [info ] [Thread-1 (]: 3 of 4 START sql table model main.stg_product_nomenclature ..................... [RUN]
[0m23:33:36.901843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:33:36.902599 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:33:36.908744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:33:36.910119 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:33:36.985355 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:33:36.986236 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */
drop table if exists "main"."stg_product_nomenclature"
[0m23:33:36.986847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:36.990418 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:33:37.000633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:33:37.002998 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:33:37.004134 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:33:37.005176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:37.006138 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:33:37.006924 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m23:33:37.009257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:37.011709 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:33:37.012638 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:33:37.013680 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:33:37.017394 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:33:37.019782 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:33:37.021923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339cca32e0>]}
[0m23:33:37.023444 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.stg_product_nomenclature ................ [[32mOK[0m in 0.12s]
[0m23:33:37.026228 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:33:37.027337 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:33:37.028548 [info ] [Thread-1 (]: 4 of 4 START sql table model main.stg_transactions ............................. [RUN]
[0m23:33:37.029737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:33:37.030558 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:33:37.039688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:33:37.041495 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:33:37.050564 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:33:37.051856 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */
drop table if exists "main"."stg_transactions"
[0m23:33:37.052641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:37.056171 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:33:37.058185 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:33:37.059663 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:33:37.060746 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:33:37.062212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:33:37.062813 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:33:37.063729 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m23:33:37.065618 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:33:37.067599 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:33:37.068995 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:33:37.071452 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:33:37.074952 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:33:37.076287 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:33:37.077332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce3f8751-c12c-4097-9215-c72eb1d4e8d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339e1450f0>]}
[0m23:33:37.078346 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.05s]
[0m23:33:37.079373 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:33:37.083324 [debug] [MainThread]: Using sqlite connection "master"
[0m23:33:37.083870 [debug] [MainThread]: On master: BEGIN
[0m23:33:37.085017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:37.086146 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:33:37.086664 [debug] [MainThread]: On master: COMMIT
[0m23:33:37.087313 [debug] [MainThread]: Using sqlite connection "master"
[0m23:33:37.087767 [debug] [MainThread]: On master: COMMIT
[0m23:33:37.088378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:33:37.088889 [debug] [MainThread]: On master: Close
[0m23:33:37.089667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:37.090111 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:33:37.090696 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:33:37.091358 [info ] [MainThread]: 
[0m23:33:37.092293 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m23:33:37.094039 [debug] [MainThread]: Command end result
[0m23:33:37.129475 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:33:37.132059 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:33:37.142737 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:33:37.144717 [info ] [MainThread]: 
[0m23:33:37.146343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:37.147917 [info ] [MainThread]: 
[0m23:33:37.148834 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:33:37.150614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6368023, "process_in_blocks": "0", "process_kernel_time": 0.28709, "process_mem_max_rss": "107696", "process_out_blocks": "2872", "process_user_time": 2.894748}
[0m23:33:37.151845 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:37.151700 after 1.64 seconds
[0m23:33:37.152774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339f676950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339debd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b339f5bcc40>]}
[0m23:33:37.153485 [debug] [MainThread]: Flushing usage events
[0m23:33:37.638192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:13.615805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91437da950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e914469bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9144698e50>]}


============================== 23:41:13.619324 | 3b0a7232-4c74-4057-a6db-de2b7f1cd5d5 ==============================
[0m23:41:13.619324 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:41:13.620228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:13.865746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91446dc1f0>]}
[0m23:41:13.933232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91446dc5b0>]}
[0m23:41:13.934322 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:41:14.077121 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:41:14.240823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:41:14.241747 [debug] [MainThread]: Partial parsing: added file: dbt_servier://models/marts/schema.yml
[0m23:41:14.243434 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/staging/source.yml
[0m23:41:14.900261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91419e4130>]}
[0m23:41:15.024627 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:41:15.027490 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:41:15.089618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e914601ee30>]}
[0m23:41:15.090378 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:41:15.090924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91439758d0>]}
[0m23:41:15.093162 [info ] [MainThread]: 
[0m23:41:15.093703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:15.094274 [info ] [MainThread]: 
[0m23:41:15.094969 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:41:15.101454 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:41:15.154836 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:41:15.157159 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:41:15.157848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:15.160103 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:41:15.160997 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:41:15.161952 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:41:15.162685 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:15.164346 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:41:15.164814 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:41:15.167911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db, now list_mydbt.db_main)
[0m23:41:15.177894 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:15.178557 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:41:15.179120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:15.180237 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:41:15.180695 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:15.181224 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:41:15.181709 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:15.183321 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:15.183817 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:41:15.184435 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:15.186342 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:41:15.186819 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:41:15.189295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9143875810>]}
[0m23:41:15.190006 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:15.190433 [debug] [MainThread]: On master: BEGIN
[0m23:41:15.190923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:15.191745 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:41:15.192325 [debug] [MainThread]: On master: COMMIT
[0m23:41:15.192787 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:15.193379 [debug] [MainThread]: On master: COMMIT
[0m23:41:15.193808 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:41:15.194335 [debug] [MainThread]: On master: Close
[0m23:41:15.197414 [debug] [Thread-1 (]: Began running node seed.dbt_servier.product_nomenclature
[0m23:41:15.198137 [info ] [Thread-1 (]: 1 of 2 START seed file main.product_nomenclature ............................... [RUN]
[0m23:41:15.198873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now seed.dbt_servier.product_nomenclature)
[0m23:41:15.199582 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.product_nomenclature
[0m23:41:15.200218 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.product_nomenclature
[0m23:41:15.248039 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:41:15.249282 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: BEGIN
[0m23:41:15.249780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:15.250983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:41:15.251556 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:41:15.253265 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.product_nomenclature"} */
delete from "main"."product_nomenclature"
[0m23:41:15.255721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:41:15.287676 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:41:15.288511 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: 
            insert into main.product_nomenclature ("product_id", "product_type", "product_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?)
        ...
[0m23:41:15.289230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:15.300482 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.product_nomenclature"
[0m23:41:15.322898 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:41:15.323678 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m23:41:15.324269 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m23:41:15.326836 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:41:15.329409 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: Close
[0m23:41:15.331396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9144aa4d60>]}
[0m23:41:15.332043 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main.product_nomenclature ........................... [[32mINSERT 4[0m in 0.13s]
[0m23:41:15.333051 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.product_nomenclature
[0m23:41:15.333599 [debug] [Thread-1 (]: Began running node seed.dbt_servier.transactions
[0m23:41:15.334282 [info ] [Thread-1 (]: 2 of 2 START seed file main.transactions ....................................... [RUN]
[0m23:41:15.334974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.product_nomenclature, now seed.dbt_servier.transactions)
[0m23:41:15.336328 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.transactions
[0m23:41:15.336867 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.transactions
[0m23:41:15.348245 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:41:15.348841 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: BEGIN
[0m23:41:15.349432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:15.350379 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:41:15.350827 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:41:15.351507 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.transactions"} */
delete from "main"."transactions"
[0m23:41:15.352644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:41:15.364502 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:41:15.365178 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: 
            insert into main.transactions ("date", "order_id", "client_id", "prod_id", "prod_price", "prod_qty") values
            (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?)
        ...
[0m23:41:15.365753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:15.366683 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.transactions"
[0m23:41:15.371604 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:41:15.372479 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m23:41:15.373912 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m23:41:15.379452 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:41:15.380678 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: Close
[0m23:41:15.381626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0a7232-4c74-4057-a6db-de2b7f1cd5d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e914237ead0>]}
[0m23:41:15.382470 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file main.transactions ................................... [[32mINSERT 5[0m in 0.05s]
[0m23:41:15.383934 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.transactions
[0m23:41:15.388652 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:15.389431 [debug] [MainThread]: On master: BEGIN
[0m23:41:15.392078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:15.394246 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:41:15.394880 [debug] [MainThread]: On master: COMMIT
[0m23:41:15.395354 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:15.395898 [debug] [MainThread]: On master: COMMIT
[0m23:41:15.396367 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:41:15.396915 [debug] [MainThread]: On master: Close
[0m23:41:15.397568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:15.398094 [debug] [MainThread]: Connection 'seed.dbt_servier.transactions' was properly closed.
[0m23:41:15.398589 [info ] [MainThread]: 
[0m23:41:15.399421 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m23:41:15.400761 [debug] [MainThread]: Command end result
[0m23:41:15.443085 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:41:15.447190 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:41:15.460758 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:41:15.461396 [info ] [MainThread]: 
[0m23:41:15.462530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:15.463921 [info ] [MainThread]: 
[0m23:41:15.464785 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:41:15.467493 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.9145964, "process_in_blocks": "0", "process_kernel_time": 0.2759, "process_mem_max_rss": "110896", "process_out_blocks": "2752", "process_user_time": 3.226447}
[0m23:41:15.476050 [debug] [MainThread]: Command `dbt seed` succeeded at 23:41:15.472109 after 1.92 seconds
[0m23:41:15.476892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e91437da950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9144aebb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e914192bf10>]}
[0m23:41:15.477701 [debug] [MainThread]: Flushing usage events
[0m23:41:15.930801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:21.262585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f1193a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f127fa3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f127fbd30>]}


============================== 23:41:21.265461 | ca91ecf2-5f2b-4f87-ab37-c86915177d95 ==============================
[0m23:41:21.265461 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:41:21.266331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:21.420165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f1283c250>]}
[0m23:41:21.489326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f10d37f10>]}
[0m23:41:21.490351 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:41:21.643397 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:41:21.820032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:21.820551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:21.894943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b69e0>]}
[0m23:41:22.019557 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:41:22.022660 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:41:22.037537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b4820>]}
[0m23:41:22.038493 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:41:22.039447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b48b0>]}
[0m23:41:22.041595 [info ] [MainThread]: 
[0m23:41:22.042360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:22.044429 [info ] [MainThread]: 
[0m23:41:22.045961 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:41:22.054547 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:41:22.106106 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:41:22.106715 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:41:22.107388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:22.108834 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:41:22.109319 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:41:22.109830 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:41:22.110571 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:22.113233 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:41:22.113827 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:41:22.115715 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:41:22.129472 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:22.130098 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:41:22.130575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:22.131524 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:41:22.132043 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:22.132449 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:41:22.132971 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:22.135772 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:41:22.138229 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:41:22.139506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:41:22.140965 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:41:22.141501 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:41:22.144462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f1030b580>]}
[0m23:41:22.145315 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:22.145867 [debug] [MainThread]: On master: BEGIN
[0m23:41:22.146400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:22.147588 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:41:22.149171 [debug] [MainThread]: On master: COMMIT
[0m23:41:22.149911 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:22.150342 [debug] [MainThread]: On master: COMMIT
[0m23:41:22.151319 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:41:22.151746 [debug] [MainThread]: On master: Close
[0m23:41:22.155283 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:41:22.156054 [info ] [Thread-1 (]: 1 of 4 START sql view model main.client_product_ventes ......................... [RUN]
[0m23:41:22.156962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:41:22.157489 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:41:22.170476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:41:22.171831 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:41:22.192512 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:41:22.194278 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */
drop view if exists "main"."client_product_ventes"
[0m23:41:22.194934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:22.202012 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m23:41:22.213072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:41:22.216733 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:41:22.218048 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:41:22.220357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.220941 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:41:22.221618 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id;
[0m23:41:22.223955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:41:22.231998 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:41:22.233172 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:41:22.234773 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:41:22.237558 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:41:22.241216 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:41:22.243669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b5a80>]}
[0m23:41:22.244596 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.client_product_ventes .................... [[32mOK[0m in 0.09s]
[0m23:41:22.245520 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:41:22.246148 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:41:22.246781 [info ] [Thread-1 (]: 2 of 4 START sql view model main.product_ventes ................................ [RUN]
[0m23:41:22.247644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:41:22.248255 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:41:22.254862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:41:22.256193 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:41:22.261761 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:41:22.262507 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */
drop view if exists "main"."product_ventes"
[0m23:41:22.263007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:22.266281 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:41:22.268645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:41:22.270005 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:41:22.270652 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:41:22.271362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.271953 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:41:22.272570 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:41:22.273536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.275630 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:41:22.276325 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:41:22.276768 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:41:22.279223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:41:22.280335 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:41:22.281195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f10304550>]}
[0m23:41:22.282248 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.product_ventes ........................... [[32mOK[0m in 0.03s]
[0m23:41:22.283406 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:41:22.284936 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:41:22.286287 [info ] [Thread-1 (]: 3 of 4 START sql table model main.stg_product_nomenclature ..................... [RUN]
[0m23:41:22.287362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:41:22.287981 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:41:22.295645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.297582 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:41:22.311030 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.311695 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */
drop table if exists "main"."stg_product_nomenclature"
[0m23:41:22.312283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:22.315333 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:41:22.324737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.326499 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.327244 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:41:22.327739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.328314 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.328745 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m23:41:22.330400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.332227 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:41:22.332787 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:41:22.333338 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:41:22.336615 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:41:22.338191 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:41:22.339126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b5a80>]}
[0m23:41:22.340165 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.stg_product_nomenclature ................ [[32mOK[0m in 0.05s]
[0m23:41:22.342473 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:41:22.343488 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:41:22.344439 [info ] [Thread-1 (]: 4 of 4 START sql table model main.stg_transactions ............................. [RUN]
[0m23:41:22.346225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:41:22.348110 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:41:22.358208 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:41:22.359485 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:41:22.364898 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:41:22.365805 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */
drop table if exists "main"."stg_transactions"
[0m23:41:22.366675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:22.370562 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:41:22.372519 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:41:22.374912 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:41:22.375585 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:41:22.376214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.379386 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:41:22.380302 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m23:41:22.381296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:41:22.383101 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:41:22.383690 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:41:22.384667 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:41:22.387946 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:41:22.389540 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:41:22.390550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca91ecf2-5f2b-4f87-ab37-c86915177d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102b5a80>]}
[0m23:41:22.391497 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.05s]
[0m23:41:22.392913 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:41:22.395306 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:22.395797 [debug] [MainThread]: On master: BEGIN
[0m23:41:22.398786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:22.402493 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m23:41:22.404299 [debug] [MainThread]: On master: COMMIT
[0m23:41:22.405826 [debug] [MainThread]: Using sqlite connection "master"
[0m23:41:22.406364 [debug] [MainThread]: On master: COMMIT
[0m23:41:22.406790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:41:22.407526 [debug] [MainThread]: On master: Close
[0m23:41:22.408377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:22.408810 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m23:41:22.409557 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:41:22.410611 [info ] [MainThread]: 
[0m23:41:22.411554 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:41:22.416424 [debug] [MainThread]: Command end result
[0m23:41:22.549622 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:41:22.552530 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:41:22.560307 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:41:22.560800 [info ] [MainThread]: 
[0m23:41:22.561771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:22.562627 [info ] [MainThread]: 
[0m23:41:22.563465 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:41:22.565011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3691262, "process_in_blocks": "0", "process_kernel_time": 0.265167, "process_mem_max_rss": "104880", "process_out_blocks": "2184", "process_user_time": 2.739073}
[0m23:41:22.565580 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:22.565467 after 1.37 seconds
[0m23:41:22.566346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f1193a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f104a09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728f102f5360>]}
[0m23:41:22.567015 [debug] [MainThread]: Flushing usage events
[0m23:41:23.020629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:44:58.992768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812f1328c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812e9c2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812e561f30>]}


============================== 23:44:58.995778 | 15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905 ==============================
[0m23:44:58.995778 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:44:58.996676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:59.149539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812defc070>]}
[0m23:44:59.216561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812f0767a0>]}
[0m23:44:59.217586 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:44:59.333675 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:44:59.506723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:59.507368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:59.581347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812dacff10>]}
[0m23:44:59.703667 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:44:59.706795 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:44:59.732684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812dcd6650>]}
[0m23:44:59.733515 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:44:59.734122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812fff3940>]}
[0m23:44:59.736341 [info ] [MainThread]: 
[0m23:44:59.736967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:59.737385 [info ] [MainThread]: 
[0m23:44:59.738162 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:44:59.745460 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:44:59.795586 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:44:59.796195 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:44:59.796616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:59.797741 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:44:59.798264 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:44:59.798682 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:44:59.799113 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:44:59.800775 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:44:59.801308 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:44:59.801821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:44:59.803255 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:44:59.803723 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:44:59.805998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15d74bcd-c3d6-45c5-9c3c-fdefcdfe6905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812dd3c7c0>]}
[0m23:44:59.806594 [debug] [MainThread]: Using sqlite connection "master"
[0m23:44:59.806970 [debug] [MainThread]: On master: BEGIN
[0m23:44:59.807521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:59.808896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:44:59.809463 [debug] [MainThread]: On master: COMMIT
[0m23:44:59.810058 [debug] [MainThread]: Using sqlite connection "master"
[0m23:44:59.810480 [debug] [MainThread]: On master: COMMIT
[0m23:44:59.811092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:44:59.811523 [debug] [MainThread]: On master: Close
[0m23:44:59.815156 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:44:59.815847 [info ] [Thread-1 (]: 1 of 9 START test not_null_client_product_ventes_client_id ..................... [RUN]
[0m23:44:59.816651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m23:44:59.817236 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:44:59.837584 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:44:59.838493 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:44:59.854321 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:44:59.855260 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:44:59.855746 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m23:44:59.856307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.857267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.857738 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:44:59.858750 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:44:59.859441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:44:59.864496 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m23:44:59.865190 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m23:44:59.866084 [info ] [Thread-1 (]: 1 of 9 PASS not_null_client_product_ventes_client_id ........................... [[32mPASS[0m in 0.05s]
[0m23:44:59.866940 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:44:59.867465 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:44:59.868045 [info ] [Thread-1 (]: 2 of 9 START test not_null_product_ventes_client_id ............................ [RUN]
[0m23:44:59.868653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_client_id.60225ead6a)
[0m23:44:59.869239 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:44:59.876162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:44:59.876932 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:44:59.880205 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:44:59.881262 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:44:59.881732 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: BEGIN
[0m23:44:59.882298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.883237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.883704 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:44:59.884317 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:44:59.884863 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: ROLLBACK
[0m23:44:59.885418 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: Close
[0m23:44:59.885937 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: client_id
[0m23:44:59.888247 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:44:59.888852 [error] [Thread-1 (]: 2 of 9 ERROR not_null_product_ventes_client_id ................................. [[31mERROR[0m in 0.02s]
[0m23:44:59.889688 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:44:59.890320 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:44:59.890841 [info ] [Thread-1 (]: 3 of 9 START test not_null_product_ventes_prod_id .............................. [RUN]
[0m23:44:59.892019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_client_id.60225ead6a, now test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff)
[0m23:44:59.892508 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:44:59.897291 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:44:59.898188 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_client_id.60225ead6a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql.
[0m23:44:59.899605 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:44:59.902248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:44:59.902917 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:44:59.903509 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: BEGIN
[0m23:44:59.904058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.905077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.905670 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:44:59.906243 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."product_ventes"
where prod_id is null



      
    ) dbt_internal_test
[0m23:44:59.906933 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: ROLLBACK
[0m23:44:59.907393 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: Close
[0m23:44:59.908004 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: prod_id
[0m23:44:59.912341 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:44:59.914216 [error] [Thread-1 (]: 3 of 9 ERROR not_null_product_ventes_prod_id ................................... [[31mERROR[0m in 0.02s]
[0m23:44:59.916240 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:44:59.916966 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:44:59.917496 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_main_product_nomenclature_product_id ......... [RUN]
[0m23:44:59.918336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m23:44:59.918928 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:44:59.925782 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql.
[0m23:44:59.927149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:44:59.927853 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:44:59.932038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:44:59.933364 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:44:59.933900 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m23:44:59.934438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.935434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.935949 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:44:59.936594 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m23:44:59.937274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:44:59.939023 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m23:44:59.939600 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m23:44:59.940679 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_main_product_nomenclature_product_id ............... [[32mPASS[0m in 0.02s]
[0m23:44:59.942107 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:44:59.942680 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:44:59.943316 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_main_transactions_client_id .................. [RUN]
[0m23:44:59.944064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m23:44:59.944551 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:44:59.948961 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:44:59.949889 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:44:59.952612 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:44:59.953368 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:44:59.953871 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m23:44:59.954416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.955361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.955925 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:44:59.956402 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m23:44:59.957037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:44:59.959081 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m23:44:59.959578 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m23:44:59.960400 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_main_transactions_client_id ........................ [[32mPASS[0m in 0.02s]
[0m23:44:59.961135 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:44:59.961781 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:44:59.962385 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_main_transactions_date ....................... [RUN]
[0m23:44:59.963212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m23:44:59.963712 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:44:59.968239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:44:59.969011 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:44:59.971684 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:44:59.972478 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:44:59.972985 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m23:44:59.973555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.974614 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.975639 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:44:59.976231 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m23:44:59.976819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:44:59.978481 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m23:44:59.979075 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m23:44:59.979885 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_main_transactions_date ............................. [[32mPASS[0m in 0.02s]
[0m23:44:59.980616 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:44:59.981225 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:44:59.981711 [info ] [Thread-1 (]: 7 of 9 START test source_not_null_main_transactions_order_id ................... [RUN]
[0m23:44:59.982422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m23:44:59.983042 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:44:59.988226 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:44:59.989149 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:44:59.992543 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:44:59.993650 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:44:59.994268 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m23:44:59.994763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:59.995793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:44:59.996430 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:44:59.996948 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m23:44:59.997632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:44:59.999389 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m23:44:59.999941 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m23:45:00.001482 [info ] [Thread-1 (]: 7 of 9 PASS source_not_null_main_transactions_order_id ......................... [[32mPASS[0m in 0.02s]
[0m23:45:00.002374 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:45:00.002961 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:00.003616 [info ] [Thread-1 (]: 8 of 9 START test source_not_null_main_transactions_prod_id .................... [RUN]
[0m23:45:00.004417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m23:45:00.005077 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:00.011546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:00.012963 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:00.064595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:00.065476 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:00.065994 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m23:45:00.067036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:00.068074 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:00.068540 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:00.069155 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m23:45:00.069752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:00.071513 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m23:45:00.072178 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m23:45:00.072991 [info ] [Thread-1 (]: 8 of 9 PASS source_not_null_main_transactions_prod_id .......................... [[32mPASS[0m in 0.07s]
[0m23:45:00.073910 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:00.074550 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:00.075802 [info ] [Thread-1 (]: 9 of 9 START test source_unique_main_product_nomenclature_product_id ........... [RUN]
[0m23:45:00.078513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m23:45:00.079268 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:00.091281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:00.095827 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:00.098778 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:00.100043 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:00.100579 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m23:45:00.101183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:00.102204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:00.102714 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:00.103355 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:45:00.103969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:00.105737 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m23:45:00.106452 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m23:45:00.107360 [info ] [Thread-1 (]: 9 of 9 PASS source_unique_main_product_nomenclature_product_id ................. [[32mPASS[0m in 0.03s]
[0m23:45:00.108730 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:00.110550 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:00.111015 [debug] [MainThread]: On master: BEGIN
[0m23:45:00.111625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:00.112604 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:00.113178 [debug] [MainThread]: On master: COMMIT
[0m23:45:00.113652 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:00.114214 [debug] [MainThread]: On master: COMMIT
[0m23:45:00.114755 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:00.115287 [debug] [MainThread]: On master: Close
[0m23:45:00.116021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:00.116445 [debug] [MainThread]: Connection 'test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717' was properly closed.
[0m23:45:00.117061 [info ] [MainThread]: 
[0m23:45:00.117553 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m23:45:00.119716 [debug] [MainThread]: Command end result
[0m23:45:00.148339 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:45:00.150487 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:45:00.159509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:45:00.160242 [info ] [MainThread]: 
[0m23:45:00.160794 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:45:00.161375 [info ] [MainThread]: 
[0m23:45:00.162060 [error] [MainThread]:   Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:45:00.162545 [info ] [MainThread]: 
[0m23:45:00.163141 [error] [MainThread]:   Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:45:00.163578 [info ] [MainThread]: 
[0m23:45:00.164036 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:45:00.165252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2361367, "process_in_blocks": "0", "process_kernel_time": 0.225828, "process_mem_max_rss": "106300", "process_out_blocks": "1992", "process_user_time": 2.706949}
[0m23:45:00.165827 [debug] [MainThread]: Command `dbt test` failed at 23:45:00.165711 after 1.24 seconds
[0m23:45:00.166432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812f1328c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812f495de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76812cc61c90>]}
[0m23:45:00.166956 [debug] [MainThread]: Flushing usage events
[0m23:45:00.616509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:33.108104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcf17e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bce9cddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bd000cb20>]}


============================== 23:45:33.111220 | fe561ffa-e2e6-473c-bfb8-30d922569d92 ==============================
[0m23:45:33.111220 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:45:33.111970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:33.251539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bd0062f20>]}
[0m23:45:33.319538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcf0c9bd0>]}
[0m23:45:33.320620 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:45:33.437469 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:45:33.608904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:33.609568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:33.683200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcdca8130>]}
[0m23:45:33.805576 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:45:33.808537 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:45:33.832748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcdc947c0>]}
[0m23:45:33.833546 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:45:33.834594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bce104cd0>]}
[0m23:45:33.836926 [info ] [MainThread]: 
[0m23:45:33.837526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:33.838137 [info ] [MainThread]: 
[0m23:45:33.838860 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:45:33.845338 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:45:33.894262 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:45:33.894792 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:45:33.895320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:33.896469 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:45:33.896901 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:45:33.897417 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:45:33.897849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:33.899487 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:45:33.899929 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:45:33.901030 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:45:33.902376 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:45:33.902844 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:45:33.905016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe561ffa-e2e6-473c-bfb8-30d922569d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcdc947c0>]}
[0m23:45:33.905623 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:33.906168 [debug] [MainThread]: On master: BEGIN
[0m23:45:33.906541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:33.907472 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:33.907968 [debug] [MainThread]: On master: COMMIT
[0m23:45:33.908693 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:33.909244 [debug] [MainThread]: On master: COMMIT
[0m23:45:33.909686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:33.910239 [debug] [MainThread]: On master: Close
[0m23:45:33.913718 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:45:33.914392 [info ] [Thread-1 (]: 1 of 9 START test not_null_client_product_ventes_client_id ..................... [RUN]
[0m23:45:33.915170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m23:45:33.915654 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:45:33.936323 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:45:33.937527 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:45:33.953754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:45:33.954905 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:45:33.955431 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m23:45:33.955993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:33.956853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:33.957422 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:45:33.957937 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:45:33.958650 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:33.963180 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m23:45:33.963727 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m23:45:33.964620 [info ] [Thread-1 (]: 1 of 9 PASS not_null_client_product_ventes_client_id ........................... [[32mPASS[0m in 0.05s]
[0m23:45:33.965450 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:45:33.965958 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:45:33.966558 [info ] [Thread-1 (]: 2 of 9 START test not_null_product_ventes_client_id ............................ [RUN]
[0m23:45:33.967667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_client_id.60225ead6a)
[0m23:45:33.968238 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:45:33.972879 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:45:33.974356 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:45:33.977112 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:45:33.978085 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:45:33.978560 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: BEGIN
[0m23:45:33.979137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:33.979961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:33.980542 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:45:33.981111 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:45:33.981689 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: ROLLBACK
[0m23:45:33.982246 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: Close
[0m23:45:33.982781 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: client_id
[0m23:45:33.985473 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:45:33.986189 [error] [Thread-1 (]: 2 of 9 ERROR not_null_product_ventes_client_id ................................. [[31mERROR[0m in 0.02s]
[0m23:45:33.987045 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:45:33.987553 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:45:33.988168 [info ] [Thread-1 (]: 3 of 9 START test not_null_product_ventes_prod_id .............................. [RUN]
[0m23:45:33.989838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_client_id.60225ead6a, now test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff)
[0m23:45:33.988903 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_client_id.60225ead6a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql.
[0m23:45:33.990500 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:45:33.996435 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:45:33.997408 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:45:34.000204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:45:34.001771 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:45:34.002387 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: BEGIN
[0m23:45:34.002840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.003759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.004336 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:45:34.004804 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."product_ventes"
where prod_id is null



      
    ) dbt_internal_test
[0m23:45:34.005443 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: ROLLBACK
[0m23:45:34.005998 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: Close
[0m23:45:34.006551 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: prod_id
[0m23:45:34.007782 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:45:34.008484 [error] [Thread-1 (]: 3 of 9 ERROR not_null_product_ventes_prod_id ................................... [[31mERROR[0m in 0.02s]
[0m23:45:34.009326 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:45:34.009941 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:45:34.010434 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_main_product_nomenclature_product_id ......... [RUN]
[0m23:45:34.011148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m23:45:34.011630 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:45:34.018298 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql.
[0m23:45:34.020214 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:45:34.021459 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:45:34.025617 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:45:34.026699 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:45:34.027291 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m23:45:34.027745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.029019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.029665 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:45:34.030230 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m23:45:34.030785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.032537 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m23:45:34.033122 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m23:45:34.034419 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_main_product_nomenclature_product_id ............... [[32mPASS[0m in 0.02s]
[0m23:45:34.035244 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:45:34.035749 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:45:34.036334 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_main_transactions_client_id .................. [RUN]
[0m23:45:34.037015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m23:45:34.037493 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:45:34.042064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:45:34.043201 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:45:34.045796 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:45:34.046829 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:45:34.047412 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m23:45:34.047868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.048807 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.049386 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:45:34.050042 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m23:45:34.051185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.052699 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m23:45:34.053353 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m23:45:34.054230 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_main_transactions_client_id ........................ [[32mPASS[0m in 0.02s]
[0m23:45:34.055128 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:45:34.055665 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:45:34.056247 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_main_transactions_date ....................... [RUN]
[0m23:45:34.057086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m23:45:34.057595 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:45:34.062190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:45:34.063148 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:45:34.066151 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:45:34.067555 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:45:34.068155 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m23:45:34.068618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.069576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.070129 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:45:34.070603 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m23:45:34.071243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.072768 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m23:45:34.073353 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m23:45:34.074172 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_main_transactions_date ............................. [[32mPASS[0m in 0.02s]
[0m23:45:34.075054 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:45:34.075595 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:45:34.076217 [info ] [Thread-1 (]: 7 of 9 START test source_not_null_main_transactions_order_id ................... [RUN]
[0m23:45:34.076835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m23:45:34.077469 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:45:34.082322 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:45:34.083395 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:45:34.086734 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:45:34.087664 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:45:34.088313 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m23:45:34.088849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.089728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.090312 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:45:34.090793 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m23:45:34.091432 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.093098 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m23:45:34.093592 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m23:45:34.094520 [info ] [Thread-1 (]: 7 of 9 PASS source_not_null_main_transactions_order_id ......................... [[32mPASS[0m in 0.02s]
[0m23:45:34.095344 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:45:34.095988 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:34.096605 [info ] [Thread-1 (]: 8 of 9 START test source_not_null_main_transactions_prod_id .................... [RUN]
[0m23:45:34.097465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m23:45:34.098049 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:34.104430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:34.105774 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:34.153292 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:34.154798 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:34.155365 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m23:45:34.155786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.156937 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.157464 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:45:34.158091 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m23:45:34.158686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.160348 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m23:45:34.160884 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m23:45:34.161767 [info ] [Thread-1 (]: 8 of 9 PASS source_not_null_main_transactions_prod_id .......................... [[32mPASS[0m in 0.06s]
[0m23:45:34.162642 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:45:34.163313 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:34.163853 [info ] [Thread-1 (]: 9 of 9 START test source_unique_main_product_nomenclature_product_id ........... [RUN]
[0m23:45:34.164615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m23:45:34.165210 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:34.172770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:34.173733 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:34.176695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:34.177701 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:34.178310 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m23:45:34.178762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.179692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:45:34.180414 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:45:34.180994 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:45:34.181585 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:45:34.183166 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m23:45:34.183661 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m23:45:34.185038 [info ] [Thread-1 (]: 9 of 9 PASS source_unique_main_product_nomenclature_product_id ................. [[32mPASS[0m in 0.02s]
[0m23:45:34.185783 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:45:34.187492 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:34.188039 [debug] [MainThread]: On master: BEGIN
[0m23:45:34.188416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:45:34.189354 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:45:34.189813 [debug] [MainThread]: On master: COMMIT
[0m23:45:34.190455 [debug] [MainThread]: Using sqlite connection "master"
[0m23:45:34.190891 [debug] [MainThread]: On master: COMMIT
[0m23:45:34.191457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:45:34.191901 [debug] [MainThread]: On master: Close
[0m23:45:34.192592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:34.193009 [debug] [MainThread]: Connection 'test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717' was properly closed.
[0m23:45:34.193678 [info ] [MainThread]: 
[0m23:45:34.194255 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m23:45:34.196606 [debug] [MainThread]: Command end result
[0m23:45:34.226821 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:45:34.230090 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:45:34.239293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:45:34.240834 [info ] [MainThread]: 
[0m23:45:34.241520 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:45:34.242005 [info ] [MainThread]: 
[0m23:45:34.242642 [error] [MainThread]:   Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:45:34.243125 [info ] [MainThread]: 
[0m23:45:34.243754 [error] [MainThread]:   Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:45:34.244329 [info ] [MainThread]: 
[0m23:45:34.244808 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:45:34.246077 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2019527, "process_in_blocks": "0", "process_kernel_time": 0.254215, "process_mem_max_rss": "106424", "process_out_blocks": "1992", "process_user_time": 2.682268}
[0m23:45:34.246626 [debug] [MainThread]: Command `dbt test` failed at 23:45:34.246515 after 1.20 seconds
[0m23:45:34.247199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bcf17e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bccc71120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724bccc710f0>]}
[0m23:45:34.247699 [debug] [MainThread]: Flushing usage events
[0m23:45:34.697347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:59.399663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1cea6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1dd6bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1dd68dc0>]}


============================== 23:45:59.402607 | e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2 ==============================
[0m23:45:59.402607 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:45:59.403412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:45:59.541611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1ddb81f0>]}
[0m23:45:59.609751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1bc3f8e0>]}
[0m23:45:59.610794 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:45:59.725683 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:45:59.897770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:45:59.898391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:45:59.976364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1b99aa10>]}
[0m23:46:00.101233 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:46:00.104140 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:46:00.117911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1b99b790>]}
[0m23:46:00.118578 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:46:00.119164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1b99b820>]}
[0m23:46:00.121293 [info ] [MainThread]: 
[0m23:46:00.121812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:00.122357 [info ] [MainThread]: 
[0m23:46:00.123091 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:46:00.130239 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m23:46:00.174034 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:46:00.174687 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m23:46:00.175178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:00.176343 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:46:00.176777 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m23:46:00.177297 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m23:46:00.178233 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:46:00.179635 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m23:46:00.180418 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m23:46:00.182644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mydbt.db, now list_mydbt.db_main)
[0m23:46:00.191300 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:00.191807 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:46:00.192330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:00.193272 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:46:00.193716 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:00.194124 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:46:00.195230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:46:00.196743 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:00.197277 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:46:00.197787 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:46:00.199065 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:46:00.199590 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:46:00.201723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1d23ae90>]}
[0m23:46:00.202392 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:00.202911 [debug] [MainThread]: On master: BEGIN
[0m23:46:00.203293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:00.204269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:46:00.204726 [debug] [MainThread]: On master: COMMIT
[0m23:46:00.205282 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:00.205712 [debug] [MainThread]: On master: COMMIT
[0m23:46:00.206275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:46:00.206721 [debug] [MainThread]: On master: Close
[0m23:46:00.210356 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m23:46:00.211489 [info ] [Thread-1 (]: 1 of 4 START sql view model main.client_product_ventes ......................... [RUN]
[0m23:46:00.212686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now model.dbt_servier.client_product_ventes)
[0m23:46:00.213430 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m23:46:00.225347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m23:46:00.226327 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m23:46:00.243552 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:46:00.244105 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */
drop view if exists "main"."client_product_ventes"
[0m23:46:00.245107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:00.248485 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:46:00.254208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m23:46:00.255238 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:46:00.255741 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m23:46:00.256366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.256922 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:46:00.257501 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE strftime('%Y', date) = '2020'
)

SELECT 
    pv.client_id, 
    pv.prod_ventes, 
    pn.product_type 
FROM product_ventes pv
LEFT JOIN main."product_nomenclature" pn
    ON pv.prod_id = pn.product_id;
[0m23:46:00.258370 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.264936 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:46:00.265609 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m23:46:00.266167 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m23:46:00.268837 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:46:00.272066 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m23:46:00.274028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1e1a0d60>]}
[0m23:46:00.274791 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main.client_product_ventes .................... [[32mOK[0m in 0.06s]
[0m23:46:00.275633 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m23:46:00.276232 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m23:46:00.276804 [info ] [Thread-1 (]: 2 of 4 START sql view model main.product_ventes ................................ [RUN]
[0m23:46:00.278223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m23:46:00.278716 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m23:46:00.282279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m23:46:00.283298 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m23:46:00.287796 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:46:00.288395 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */
drop view if exists "main"."product_ventes"
[0m23:46:00.288999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:00.292125 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:46:00.293729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m23:46:00.295225 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:46:00.295793 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m23:46:00.296377 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.296823 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:46:00.297407 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    prod_price * prod_qty AS prod_ventes
FROM main."transactions"
WHERE strftime('%Y', date) = '2020';
[0m23:46:00.298145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.299527 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:46:00.300113 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m23:46:00.300563 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m23:46:00.303044 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:46:00.303963 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m23:46:00.304867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1b7f5ff0>]}
[0m23:46:00.305669 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.product_ventes ........................... [[32mOK[0m in 0.03s]
[0m23:46:00.306509 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m23:46:00.307119 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m23:46:00.307711 [info ] [Thread-1 (]: 3 of 4 START sql table model main.stg_product_nomenclature ..................... [RUN]
[0m23:46:00.308533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_product_nomenclature)
[0m23:46:00.309010 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m23:46:00.314655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.315590 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m23:46:00.326096 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.326925 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */
drop table if exists "main"."stg_product_nomenclature"
[0m23:46:00.327417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:00.331140 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:46:00.337306 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.338277 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.338888 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m23:46:00.339469 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.339958 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.340515 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m23:46:00.341317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.342748 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:46:00.343356 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m23:46:00.343822 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m23:46:00.347118 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:46:00.348172 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m23:46:00.349041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1e1a0d60>]}
[0m23:46:00.349767 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.stg_product_nomenclature ................ [[32mOK[0m in 0.04s]
[0m23:46:00.350583 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m23:46:00.351214 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m23:46:00.351771 [info ] [Thread-1 (]: 4 of 4 START sql table model main.stg_transactions ............................. [RUN]
[0m23:46:00.352562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now model.dbt_servier.stg_transactions)
[0m23:46:00.353143 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m23:46:00.358250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m23:46:00.359446 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m23:46:00.364872 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:46:00.365665 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */
drop table if exists "main"."stg_transactions"
[0m23:46:00.366239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:00.369526 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:46:00.371180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m23:46:00.372115 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:46:00.372612 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m23:46:00.373168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.373649 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:46:00.374189 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m23:46:00.374956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:00.376299 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:46:00.376900 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m23:46:00.377356 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m23:46:00.380509 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:46:00.381538 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m23:46:00.382417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43a7880-fd8a-465a-93f8-fb3c7cb1dbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1aadc3a0>]}
[0m23:46:00.383362 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.stg_transactions ........................ [[32mOK[0m in 0.03s]
[0m23:46:00.384172 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m23:46:00.386020 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:00.386597 [debug] [MainThread]: On master: BEGIN
[0m23:46:00.387066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:00.387877 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:46:00.388480 [debug] [MainThread]: On master: COMMIT
[0m23:46:00.388960 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:00.389492 [debug] [MainThread]: On master: COMMIT
[0m23:46:00.390045 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:46:00.390487 [debug] [MainThread]: On master: Close
[0m23:46:00.391152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:00.391576 [debug] [MainThread]: Connection 'model.dbt_servier.stg_transactions' was properly closed.
[0m23:46:00.392199 [info ] [MainThread]: 
[0m23:46:00.392690 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:46:00.394205 [debug] [MainThread]: Command end result
[0m23:46:00.465385 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:46:00.467261 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:46:00.474431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:46:00.475117 [info ] [MainThread]: 
[0m23:46:00.475637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:46:00.476150 [info ] [MainThread]: 
[0m23:46:00.476620 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:46:00.478217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1517633, "process_in_blocks": "0", "process_kernel_time": 0.236992, "process_mem_max_rss": "104624", "process_out_blocks": "2192", "process_user_time": 2.618917}
[0m23:46:00.478789 [debug] [MainThread]: Command `dbt run` succeeded at 23:46:00.478666 after 1.15 seconds
[0m23:46:00.479367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1cea6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1d1c8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769c1b99e7d0>]}
[0m23:46:00.480001 [debug] [MainThread]: Flushing usage events
[0m23:46:00.932543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:23.584032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497ecc6980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497e515db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497fc54b20>]}


============================== 23:46:23.586978 | f43fd9c3-2aaa-4326-9f18-44efadfe67d0 ==============================
[0m23:46:23.586978 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:46:23.588423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:23.745753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497fcaaf20>]}
[0m23:46:23.812454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497ec11bd0>]}
[0m23:46:23.813501 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:46:23.951856 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:46:24.126319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:24.126922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:24.201159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497d894130>]}
[0m23:46:24.336228 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:46:24.340446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:46:24.367376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497d8807c0>]}
[0m23:46:24.368141 [info ] [MainThread]: Found 4 models, 2 seeds, 9 data tests, 2 sources, 413 macros
[0m23:46:24.368663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497fce4cd0>]}
[0m23:46:24.371444 [info ] [MainThread]: 
[0m23:46:24.372107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:24.372573 [info ] [MainThread]: 
[0m23:46:24.373340 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:46:24.381210 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:46:24.435128 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:24.435838 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:46:24.436340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:24.438195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:46:24.438823 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:24.439436 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:46:24.440021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:46:24.441787 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:46:24.443059 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:46:24.444328 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:46:24.448078 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:46:24.448762 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:46:24.451421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f43fd9c3-2aaa-4326-9f18-44efadfe67d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497d8807c0>]}
[0m23:46:24.452439 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:24.452940 [debug] [MainThread]: On master: BEGIN
[0m23:46:24.453596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:24.454997 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:46:24.455594 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.456367 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:24.457642 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.458396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:46:24.458911 [debug] [MainThread]: On master: Close
[0m23:46:24.462691 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:46:24.463346 [info ] [Thread-1 (]: 1 of 9 START test not_null_client_product_ventes_client_id ..................... [RUN]
[0m23:46:24.464438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m23:46:24.465064 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:46:24.493950 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:46:24.495544 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:46:24.526659 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:46:24.528565 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:46:24.529910 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m23:46:24.530431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.531456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.532003 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:46:24.532631 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:46:24.533468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.541104 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m23:46:24.542114 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m23:46:24.543067 [info ] [Thread-1 (]: 1 of 9 PASS not_null_client_product_ventes_client_id ........................... [[32mPASS[0m in 0.08s]
[0m23:46:24.544182 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:46:24.544923 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:46:24.545456 [info ] [Thread-1 (]: 2 of 9 START test not_null_product_ventes_client_id ............................ [RUN]
[0m23:46:24.546370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_client_id.60225ead6a)
[0m23:46:24.547331 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:46:24.555133 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:46:24.556411 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:46:24.559754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:46:24.561254 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:46:24.561835 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: BEGIN
[0m23:46:24.562385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.563519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.564215 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"
[0m23:46:24.564892 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_client_id.60225ead6a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:46:24.565537 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: ROLLBACK
[0m23:46:24.566198 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_client_id.60225ead6a: Close
[0m23:46:24.566831 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: client_id
[0m23:46:24.569395 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:46:24.570326 [error] [Thread-1 (]: 2 of 9 ERROR not_null_product_ventes_client_id ................................. [[31mERROR[0m in 0.02s]
[0m23:46:24.571744 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_client_id.60225ead6a
[0m23:46:24.572449 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:46:24.572968 [info ] [Thread-1 (]: 3 of 9 START test not_null_product_ventes_prod_id .............................. [RUN]
[0m23:46:24.573714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_client_id.60225ead6a, now test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff)
[0m23:46:24.575440 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:46:24.574698 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_client_id.60225ead6a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql.
[0m23:46:24.581707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:46:24.584062 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:46:24.587442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:46:24.589725 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:46:24.590445 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: BEGIN
[0m23:46:24.590944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.592002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.592661 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"
[0m23:46:24.593329 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."product_ventes"
where prod_id is null



      
    ) dbt_internal_test
[0m23:46:24.593977 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: ROLLBACK
[0m23:46:24.594633 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff: Close
[0m23:46:24.595343 [debug] [Thread-1 (]: SQLite adapter: sqlite3 error: no such column: prod_id
[0m23:46:24.596963 [debug] [Thread-1 (]: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:46:24.598126 [error] [Thread-1 (]: 3 of 9 ERROR not_null_product_ventes_prod_id ................................... [[31mERROR[0m in 0.02s]
[0m23:46:24.599009 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff
[0m23:46:24.599711 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:46:24.601115 [info ] [Thread-1 (]: 4 of 9 START test source_not_null_main_product_nomenclature_product_id ......... [RUN]
[0m23:46:24.601960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m23:46:24.602562 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:46:24.600450 [debug] [Thread-4 (]: Marking all children of 'test.dbt_servier.not_null_product_ventes_prod_id.82d3e517ff' to be skipped because of status 'error'.  Reason: Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql.
[0m23:46:24.613709 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:46:24.615719 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:46:24.622850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:46:24.624826 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:46:24.625808 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m23:46:24.626373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.627342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.628075 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:46:24.629462 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m23:46:24.630472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.632397 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m23:46:24.633197 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m23:46:24.635163 [info ] [Thread-1 (]: 4 of 9 PASS source_not_null_main_product_nomenclature_product_id ............... [[32mPASS[0m in 0.03s]
[0m23:46:24.637109 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:46:24.638293 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:46:24.638898 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_main_transactions_client_id .................. [RUN]
[0m23:46:24.639948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m23:46:24.640634 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:46:24.647244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:46:24.648664 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:46:24.654076 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:46:24.656158 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:46:24.656819 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m23:46:24.657755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.659674 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:46:24.660529 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:46:24.661635 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m23:46:24.663391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.665227 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m23:46:24.665777 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m23:46:24.666698 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_main_transactions_client_id ........................ [[32mPASS[0m in 0.03s]
[0m23:46:24.667645 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:46:24.668382 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:46:24.669043 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_main_transactions_date ....................... [RUN]
[0m23:46:24.669816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m23:46:24.670531 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:46:24.678296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:46:24.679980 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:46:24.684829 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:46:24.686713 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:46:24.687557 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m23:46:24.688661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.689735 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.690375 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:46:24.690974 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m23:46:24.691885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.694875 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m23:46:24.695621 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m23:46:24.696569 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_main_transactions_date ............................. [[32mPASS[0m in 0.03s]
[0m23:46:24.697627 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:46:24.698367 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:46:24.699005 [info ] [Thread-1 (]: 7 of 9 START test source_not_null_main_transactions_order_id ................... [RUN]
[0m23:46:24.700352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m23:46:24.701316 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:46:24.712342 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:46:24.713759 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:46:24.720009 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:46:24.721872 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:46:24.722583 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m23:46:24.723164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.724400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.725225 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:46:24.725880 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m23:46:24.727063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.730802 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m23:46:24.731613 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m23:46:24.732575 [info ] [Thread-1 (]: 7 of 9 PASS source_not_null_main_transactions_order_id ......................... [[32mPASS[0m in 0.03s]
[0m23:46:24.733763 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:46:24.734543 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:46:24.735296 [info ] [Thread-1 (]: 8 of 9 START test source_not_null_main_transactions_prod_id .................... [RUN]
[0m23:46:24.736101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m23:46:24.736921 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:46:24.745477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:46:24.746783 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:46:24.813228 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:46:24.814553 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:46:24.815251 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m23:46:24.816346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.818262 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:46:24.818828 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:46:24.819422 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m23:46:24.819961 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.823071 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m23:46:24.824038 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m23:46:24.825985 [info ] [Thread-1 (]: 8 of 9 PASS source_not_null_main_transactions_prod_id .......................... [[32mPASS[0m in 0.09s]
[0m23:46:24.827537 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:46:24.830879 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:46:24.831767 [info ] [Thread-1 (]: 9 of 9 START test source_unique_main_product_nomenclature_product_id ........... [RUN]
[0m23:46:24.833046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m23:46:24.833624 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:46:24.844083 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:46:24.845485 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:46:24.848502 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:46:24.849717 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:46:24.850340 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m23:46:24.850820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:24.851862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:46:24.852477 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:46:24.852945 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:46:24.853698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:46:24.856023 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m23:46:24.856637 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m23:46:24.857666 [info ] [Thread-1 (]: 9 of 9 PASS source_unique_main_product_nomenclature_product_id ................. [[32mPASS[0m in 0.03s]
[0m23:46:24.858848 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:46:24.860990 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:24.861867 [debug] [MainThread]: On master: BEGIN
[0m23:46:24.862572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:24.864256 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:46:24.865020 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.865752 [debug] [MainThread]: Using sqlite connection "master"
[0m23:46:24.866349 [debug] [MainThread]: On master: COMMIT
[0m23:46:24.866964 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:46:24.867498 [debug] [MainThread]: On master: Close
[0m23:46:24.868338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:24.868756 [debug] [MainThread]: Connection 'test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717' was properly closed.
[0m23:46:24.869525 [info ] [MainThread]: 
[0m23:46:24.870245 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m23:46:24.872995 [debug] [MainThread]: Command end result
[0m23:46:24.931616 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:46:24.941426 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:46:24.979059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:46:24.979651 [info ] [MainThread]: 
[0m23:46:24.985004 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:46:24.985639 [info ] [MainThread]: 
[0m23:46:24.988649 [error] [MainThread]:   Database Error in test not_null_product_ventes_client_id (models/marts/schema.yml)
  no such column: client_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_client_id.sql
[0m23:46:24.989238 [info ] [MainThread]: 
[0m23:46:24.993956 [error] [MainThread]:   Database Error in test not_null_product_ventes_prod_id (models/marts/schema.yml)
  no such column: prod_id
  compiled code at target/run/dbt_servier/models/marts/schema.yml/not_null_product_ventes_prod_id.sql
[0m23:46:24.994799 [info ] [MainThread]: 
[0m23:46:24.998487 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m23:46:25.002112 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.481495, "process_in_blocks": "0", "process_kernel_time": 0.288877, "process_mem_max_rss": "106164", "process_out_blocks": "1992", "process_user_time": 2.80142}
[0m23:46:25.006075 [debug] [MainThread]: Command `dbt test` failed at 23:46:25.002592 after 1.48 seconds
[0m23:46:25.006992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497ecc6980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497c8646d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77497c865390>]}
[0m23:46:25.008231 [debug] [MainThread]: Flushing usage events
[0m23:46:25.491744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:48:04.841500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8b43a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8c2faec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8c2fbe20>]}


============================== 23:48:04.845011 | ef08fe8d-d8e1-4c89-9e69-0647e9b240f0 ==============================
[0m23:48:04.845011 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:48:04.845712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:05.005765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8c2f9a50>]}
[0m23:48:05.074362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8b388f40>]}
[0m23:48:05.075417 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m23:48:05.197426 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:48:05.370892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:05.371894 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/marts/schema.yml
[0m23:48:05.874375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd89538d90>]}
[0m23:48:05.993483 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:48:05.996696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:48:06.020049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd89f45810>]}
[0m23:48:06.020744 [info ] [MainThread]: Found 2 seeds, 4 models, 8 data tests, 2 sources, 413 macros
[0m23:48:06.021360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd89f455a0>]}
[0m23:48:06.023684 [info ] [MainThread]: 
[0m23:48:06.024271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:06.024690 [info ] [MainThread]: 
[0m23:48:06.025741 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m23:48:06.033414 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m23:48:06.143548 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:48:06.144181 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m23:48:06.145117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:06.146253 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:48:06.146676 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:48:06.147179 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m23:48:06.147607 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:48:06.149193 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m23:48:06.149742 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m23:48:06.150312 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:48:06.151613 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m23:48:06.152161 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m23:48:06.153933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef08fe8d-d8e1-4c89-9e69-0647e9b240f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd89d60550>]}
[0m23:48:06.154606 [debug] [MainThread]: Using sqlite connection "master"
[0m23:48:06.155015 [debug] [MainThread]: On master: BEGIN
[0m23:48:06.155521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:06.156526 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:48:06.156952 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.157487 [debug] [MainThread]: Using sqlite connection "master"
[0m23:48:06.157887 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.158404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:48:06.158848 [debug] [MainThread]: On master: Close
[0m23:48:06.162810 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:48:06.163585 [info ] [Thread-1 (]: 1 of 8 START test not_null_client_product_ventes_client_id ..................... [RUN]
[0m23:48:06.164334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m23:48:06.165051 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:48:06.185718 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:48:06.187046 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:48:06.205583 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:48:06.207402 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:48:06.208153 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m23:48:06.208627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.209621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:48:06.210228 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m23:48:06.210920 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m23:48:06.212439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.220248 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m23:48:06.221119 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m23:48:06.221971 [info ] [Thread-1 (]: 1 of 8 PASS not_null_client_product_ventes_client_id ........................... [[32mPASS[0m in 0.06s]
[0m23:48:06.224468 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m23:48:06.225860 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m23:48:06.226477 [info ] [Thread-1 (]: 2 of 8 START test not_null_product_ventes_date ................................. [RUN]
[0m23:48:06.227589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_date.e36dd44ea0)
[0m23:48:06.228652 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m23:48:06.234105 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m23:48:06.234951 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m23:48:06.238080 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m23:48:06.239101 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m23:48:06.239620 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: BEGIN
[0m23:48:06.240570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.242904 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:48:06.243454 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m23:48:06.243979 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."product_ventes"
where date is null



      
    ) dbt_internal_test
[0m23:48:06.245053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.246713 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: ROLLBACK
[0m23:48:06.247382 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: Close
[0m23:48:06.248579 [info ] [Thread-1 (]: 2 of 8 PASS not_null_product_ventes_date ....................................... [[32mPASS[0m in 0.02s]
[0m23:48:06.249954 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m23:48:06.250655 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:48:06.251252 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_main_product_nomenclature_product_id ......... [RUN]
[0m23:48:06.251953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_product_ventes_date.e36dd44ea0, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m23:48:06.252486 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:48:06.263884 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:48:06.265252 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:48:06.270311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:48:06.271560 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:48:06.272168 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m23:48:06.272604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.273648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:48:06.274410 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m23:48:06.275168 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m23:48:06.276219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.278667 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m23:48:06.279797 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m23:48:06.281846 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_main_product_nomenclature_product_id ............... [[32mPASS[0m in 0.03s]
[0m23:48:06.283492 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m23:48:06.284216 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:48:06.285033 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_main_transactions_client_id .................. [RUN]
[0m23:48:06.286032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m23:48:06.287021 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:48:06.292736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:48:06.294114 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:48:06.298433 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:48:06.299682 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:48:06.300346 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m23:48:06.300802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.303048 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:48:06.303671 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m23:48:06.304131 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m23:48:06.305043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.306826 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m23:48:06.307548 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m23:48:06.308983 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_main_transactions_client_id ........................ [[32mPASS[0m in 0.02s]
[0m23:48:06.310446 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m23:48:06.311546 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:48:06.312415 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_main_transactions_date ....................... [RUN]
[0m23:48:06.313353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m23:48:06.313833 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:48:06.320326 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:48:06.321893 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:48:06.326702 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:48:06.329210 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:48:06.329775 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m23:48:06.330652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.333235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:48:06.333990 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m23:48:06.334467 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m23:48:06.335207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.337399 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m23:48:06.338223 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m23:48:06.339839 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_main_transactions_date ............................. [[32mPASS[0m in 0.03s]
[0m23:48:06.341122 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m23:48:06.341986 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:48:06.342727 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_main_transactions_order_id ................... [RUN]
[0m23:48:06.343774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m23:48:06.344929 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:48:06.351241 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:48:06.352260 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:48:06.358745 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:48:06.360255 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:48:06.360796 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m23:48:06.361735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.362686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:48:06.363354 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m23:48:06.363802 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m23:48:06.364416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.366780 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m23:48:06.367597 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m23:48:06.368585 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_main_transactions_order_id ......................... [[32mPASS[0m in 0.02s]
[0m23:48:06.370570 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m23:48:06.371375 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:48:06.372216 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_main_transactions_prod_id .................... [RUN]
[0m23:48:06.373914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m23:48:06.374679 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:48:06.384487 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:48:06.386720 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:48:06.392081 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:48:06.393619 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:48:06.394980 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m23:48:06.396036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.398046 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:48:06.399161 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m23:48:06.399974 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m23:48:06.400803 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.403758 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m23:48:06.405105 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m23:48:06.408362 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_main_transactions_prod_id .......................... [[32mPASS[0m in 0.03s]
[0m23:48:06.412778 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m23:48:06.416944 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:48:06.420111 [info ] [Thread-1 (]: 8 of 8 START test source_unique_main_product_nomenclature_product_id ........... [RUN]
[0m23:48:06.420917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m23:48:06.421554 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:48:06.432533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:48:06.434138 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:48:06.437692 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:48:06.439209 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:48:06.440243 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m23:48:06.440905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:06.442156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:48:06.442853 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m23:48:06.443535 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:48:06.445601 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:48:06.449322 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m23:48:06.450891 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m23:48:06.453134 [info ] [Thread-1 (]: 8 of 8 PASS source_unique_main_product_nomenclature_product_id ................. [[32mPASS[0m in 0.03s]
[0m23:48:06.455521 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m23:48:06.459725 [debug] [MainThread]: Using sqlite connection "master"
[0m23:48:06.460627 [debug] [MainThread]: On master: BEGIN
[0m23:48:06.462507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:06.464212 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:48:06.464837 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.465508 [debug] [MainThread]: Using sqlite connection "master"
[0m23:48:06.466083 [debug] [MainThread]: On master: COMMIT
[0m23:48:06.466997 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:48:06.467485 [debug] [MainThread]: On master: Close
[0m23:48:06.468967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:06.470477 [debug] [MainThread]: Connection 'test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717' was properly closed.
[0m23:48:06.471081 [info ] [MainThread]: 
[0m23:48:06.471887 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m23:48:06.474383 [debug] [MainThread]: Command end result
[0m23:48:06.514957 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m23:48:06.519345 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m23:48:06.532624 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m23:48:06.533419 [info ] [MainThread]: 
[0m23:48:06.537160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:06.538769 [info ] [MainThread]: 
[0m23:48:06.541434 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:48:06.545784 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.768287, "process_in_blocks": "0", "process_kernel_time": 0.272101, "process_mem_max_rss": "111412", "process_out_blocks": "2792", "process_user_time": 3.193454}
[0m23:48:06.546769 [debug] [MainThread]: Command `dbt test` succeeded at 23:48:06.546580 after 1.77 seconds
[0m23:48:06.548455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8b43a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd8b37fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcd89e99090>]}
[0m23:48:06.549561 [debug] [MainThread]: Flushing usage events
[0m23:48:06.999121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:56.492775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b22276980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b21ac5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b23105810>]}


============================== 11:28:56.497440 | 7fc6100a-620e-4b03-ba32-456daa097442 ==============================
[0m11:28:56.497440 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:28:56.498591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:28:56.679197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b2315af20>]}
[0m11:28:56.742954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b221c1bd0>]}
[0m11:28:56.747781 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m11:28:56.939992 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:28:57.214808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:28:57.215781 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/marts/client_product_ventes.sql
[0m11:28:57.216352 [debug] [MainThread]: Partial parsing: updated file: dbt_servier://models/marts/product_ventes.sql
[0m11:28:57.809697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b207e4f40>]}
[0m11:28:57.936036 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m11:28:57.939245 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m11:28:57.999831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b207df010>]}
[0m11:28:58.000574 [info ] [MainThread]: Found 2 seeds, 4 models, 8 data tests, 2 sources, 413 macros
[0m11:28:58.003724 [info ] [MainThread]: 
[0m11:28:58.004370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:58.004996 [info ] [MainThread]: 
[0m11:28:58.005908 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m11:28:58.013697 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m11:28:58.143640 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m11:28:58.144339 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m11:28:58.144959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:58.146288 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:28:58.146831 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m11:28:58.147361 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m11:28:58.148001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:58.149683 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m11:28:58.150132 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m11:28:58.152170 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m11:28:58.162935 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:28:58.163465 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m11:28:58.163990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:58.165107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:28:58.165623 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:28:58.166043 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m11:28:58.166517 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:58.168056 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:28:58.168604 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m11:28:58.169089 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:58.170489 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m11:28:58.170929 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m11:28:58.173063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b20b39090>]}
[0m11:28:58.173847 [debug] [MainThread]: Using sqlite connection "master"
[0m11:28:58.174285 [debug] [MainThread]: On master: BEGIN
[0m11:28:58.174887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:58.175939 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:28:58.176378 [debug] [MainThread]: On master: COMMIT
[0m11:28:58.177011 [debug] [MainThread]: Using sqlite connection "master"
[0m11:28:58.177522 [debug] [MainThread]: On master: COMMIT
[0m11:28:58.178262 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:58.178863 [debug] [MainThread]: On master: Close
[0m11:28:58.183198 [debug] [Thread-1 (]: Began running node seed.dbt_servier.product_nomenclature
[0m11:28:58.183943 [info ] [Thread-1 (]: 1 of 14 START seed file main.product_nomenclature .............................. [RUN]
[0m11:28:58.184618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now seed.dbt_servier.product_nomenclature)
[0m11:28:58.185111 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.product_nomenclature
[0m11:28:58.185764 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.product_nomenclature
[0m11:28:58.228369 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:28:58.229081 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: BEGIN
[0m11:28:58.229536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.230601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.231099 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:28:58.231827 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.product_nomenclature"} */
delete from "main"."product_nomenclature"
[0m11:28:58.232877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.255173 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:28:58.255909 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: 
            insert into main.product_nomenclature ("product_id", "product_type", "product_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?)
        ...
[0m11:28:58.256570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.262689 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.product_nomenclature"
[0m11:28:58.286630 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m11:28:58.287427 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:28:58.288268 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m11:28:58.291083 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:58.293532 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: Close
[0m11:28:58.296489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b225d5f00>]}
[0m11:28:58.297246 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file main.product_nomenclature .......................... [[32mINSERT 4[0m in 0.11s]
[0m11:28:58.298189 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.product_nomenclature
[0m11:28:58.298869 [debug] [Thread-1 (]: Began running node seed.dbt_servier.transactions
[0m11:28:58.299612 [info ] [Thread-1 (]: 2 of 14 START seed file main.transactions ...................................... [RUN]
[0m11:28:58.300332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.product_nomenclature, now seed.dbt_servier.transactions)
[0m11:28:58.300936 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.transactions
[0m11:28:58.301551 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.transactions
[0m11:28:58.311327 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:28:58.312112 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: BEGIN
[0m11:28:58.312673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.313574 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.314220 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:28:58.314915 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.transactions"} */
delete from "main"."transactions"
[0m11:28:58.315950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.328821 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:28:58.329560 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: 
            insert into main.transactions ("date", "order_id", "client_id", "prod_id", "prod_price", "prod_qty") values
            (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?)
        ...
[0m11:28:58.330188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.331249 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.transactions"
[0m11:28:58.334579 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m11:28:58.335374 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:28:58.336008 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m11:28:58.339040 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:58.340161 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: Close
[0m11:28:58.341139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b225d5f00>]}
[0m11:28:58.342006 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file main.transactions .................................. [[32mINSERT 5[0m in 0.04s]
[0m11:28:58.343208 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.transactions
[0m11:28:58.344093 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:28:58.345139 [info ] [Thread-1 (]: 3 of 14 START test source_not_null_main_product_nomenclature_product_id ........ [RUN]
[0m11:28:58.345917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.transactions, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m11:28:58.346442 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:28:58.367600 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:28:58.368796 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:28:58.383888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:28:58.385088 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:28:58.385589 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m11:28:58.386168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.387163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.387640 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:28:58.388259 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m11:28:58.388917 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.392424 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m11:28:58.393237 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m11:28:58.394166 [info ] [Thread-1 (]: 3 of 14 PASS source_not_null_main_product_nomenclature_product_id .............. [[32mPASS[0m in 0.05s]
[0m11:28:58.395169 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:28:58.395977 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:28:58.396457 [info ] [Thread-1 (]: 4 of 14 START test source_not_null_main_transactions_client_id ................. [RUN]
[0m11:28:58.397762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m11:28:58.398554 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:28:58.405406 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:28:58.406843 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:28:58.409578 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:28:58.411017 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:28:58.411661 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m11:28:58.412260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.413280 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.413903 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:28:58.414521 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m11:28:58.415114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.416853 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m11:28:58.417471 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m11:28:58.418500 [info ] [Thread-1 (]: 4 of 14 PASS source_not_null_main_transactions_client_id ....................... [[32mPASS[0m in 0.02s]
[0m11:28:58.419685 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:28:58.420310 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:28:58.421099 [info ] [Thread-1 (]: 5 of 14 START test source_not_null_main_transactions_date ...................... [RUN]
[0m11:28:58.422052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m11:28:58.422681 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:28:58.433421 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:28:58.435119 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:28:58.438069 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:28:58.439267 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:28:58.439853 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m11:28:58.440272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.441242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.441835 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:28:58.442319 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m11:28:58.443296 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.445173 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m11:28:58.445731 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m11:28:58.446796 [info ] [Thread-1 (]: 5 of 14 PASS source_not_null_main_transactions_date ............................ [[32mPASS[0m in 0.02s]
[0m11:28:58.447841 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:28:58.448376 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:28:58.449264 [info ] [Thread-1 (]: 6 of 14 START test source_not_null_main_transactions_order_id .................. [RUN]
[0m11:28:58.450246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m11:28:58.450896 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:28:58.459371 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:28:58.461015 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:28:58.464937 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:28:58.466415 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:28:58.467137 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m11:28:58.467643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.468789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.469366 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:28:58.470058 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m11:28:58.470769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.475276 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m11:28:58.476060 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m11:28:58.479382 [info ] [Thread-1 (]: 6 of 14 PASS source_not_null_main_transactions_order_id ........................ [[32mPASS[0m in 0.03s]
[0m11:28:58.481381 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:28:58.482273 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:28:58.482950 [info ] [Thread-1 (]: 7 of 14 START test source_not_null_main_transactions_prod_id ................... [RUN]
[0m11:28:58.484029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m11:28:58.484739 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:28:58.490449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:28:58.491960 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:28:58.496805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:28:58.498336 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:28:58.499084 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m11:28:58.499940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.503738 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.504353 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:28:58.505007 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m11:28:58.505683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.507237 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m11:28:58.507857 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m11:28:58.508552 [info ] [Thread-1 (]: 7 of 14 PASS source_not_null_main_transactions_prod_id ......................... [[32mPASS[0m in 0.02s]
[0m11:28:58.509771 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:28:58.510711 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:28:58.511646 [info ] [Thread-1 (]: 8 of 14 START test source_unique_main_product_nomenclature_product_id .......... [RUN]
[0m11:28:58.512625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m11:28:58.513249 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:28:58.522151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:28:58.523922 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:28:58.527434 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:28:58.529132 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:28:58.532106 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m11:28:58.533870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.535750 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:28:58.537623 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:28:58.538675 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:28:58.539608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.541851 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m11:28:58.542541 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m11:28:58.543693 [info ] [Thread-1 (]: 8 of 14 PASS source_unique_main_product_nomenclature_product_id ................ [[32mPASS[0m in 0.03s]
[0m11:28:58.547333 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:28:58.548015 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m11:28:58.548981 [info ] [Thread-1 (]: 9 of 14 START sql view model main.client_product_ventes ........................ [RUN]
[0m11:28:58.550238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717, now model.dbt_servier.client_product_ventes)
[0m11:28:58.550972 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m11:28:58.557495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m11:28:58.559136 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m11:28:58.572947 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:28:58.573707 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */
drop view if exists "main"."client_product_ventes"
[0m11:28:58.574222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.578227 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.584040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m11:28:58.585661 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:28:58.586269 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m11:28:58.588998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.591565 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:28:58.592181 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE date BETWEEN "2020-01-01" AND "2020-12-31"
), client_product_ventes AS (
    SELECT 
        pv.client_id, 
        pv.prod_ventes, 
        pn.product_type 
    FROM product_ventes pv
    LEFT JOIN main."product_nomenclature" pn
        ON pv.prod_id = pn.product_id
)

SELECT
    client_id,
    SUM(CASE WHEN product_type = 'MEUBLE' THEN prod_ventes END) AS ventes_meuble,
    SUM(CASE WHEN product_type = 'DECO' THEN prod_ventes END) AS ventes_deco
FROM 
    client_product_ventes
GROUP BY 
    client_id;
[0m11:28:58.593348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.595295 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m11:28:58.596197 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:28:58.597129 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m11:28:58.599796 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:58.601053 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m11:28:58.602030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b21ac64d0>]}
[0m11:28:58.602968 [info ] [Thread-1 (]: 9 of 14 OK created sql view model main.client_product_ventes ................... [[32mOK[0m in 0.05s]
[0m11:28:58.604390 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m11:28:58.605144 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m11:28:58.606276 [info ] [Thread-1 (]: 10 of 14 START sql view model main.product_ventes .............................. [RUN]
[0m11:28:58.609817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m11:28:58.610456 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m11:28:58.614835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m11:28:58.616584 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m11:28:58.622914 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:28:58.623592 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */
drop view if exists "main"."product_ventes"
[0m11:28:58.624141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.627752 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.629441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m11:28:58.630858 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:28:58.631857 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m11:28:58.632387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.632997 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:28:58.633487 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    SUM(prod_price * prod_qty) AS ventes
FROM main."transactions"
WHERE date BETWEEN "2020-01-01" AND "2020-12-31"
GROUP BY date
ORDER BY date;
[0m11:28:58.634540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.636229 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m11:28:58.636971 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:28:58.637622 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m11:28:58.641807 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.642993 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m11:28:58.644213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b21a87700>]}
[0m11:28:58.645159 [info ] [Thread-1 (]: 10 of 14 OK created sql view model main.product_ventes ......................... [[32mOK[0m in 0.03s]
[0m11:28:58.646375 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m11:28:58.647039 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m11:28:58.647771 [info ] [Thread-1 (]: 11 of 14 START sql table model main.stg_transactions ........................... [RUN]
[0m11:28:58.648725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_transactions)
[0m11:28:58.649599 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m11:28:58.655046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m11:28:58.656592 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m11:28:58.668421 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:28:58.671462 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */
drop table if exists "main"."stg_transactions"
[0m11:28:58.672310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.676138 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.683017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m11:28:58.684297 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:28:58.684846 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m11:28:58.685522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.686012 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:28:58.686609 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m11:28:58.687542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.688980 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m11:28:58.689589 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:28:58.690077 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m11:28:58.692870 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:58.694246 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m11:28:58.695186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b21532920>]}
[0m11:28:58.696038 [info ] [Thread-1 (]: 11 of 14 OK created sql table model main.stg_transactions ...................... [[32mOK[0m in 0.05s]
[0m11:28:58.697097 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m11:28:58.697775 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m11:28:58.698696 [info ] [Thread-1 (]: 12 of 14 START sql table model main.stg_product_nomenclature ................... [RUN]
[0m11:28:58.701337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_transactions, now model.dbt_servier.stg_product_nomenclature)
[0m11:28:58.702806 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m11:28:58.710083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.711636 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m11:28:58.717104 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.717820 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */
drop table if exists "main"."stg_product_nomenclature"
[0m11:28:58.718309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.721930 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:28:58.723979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.725324 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.725985 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m11:28:58.726533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.727135 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.727722 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m11:28:58.728669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.730853 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m11:28:58.731935 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:28:58.732416 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m11:28:58.734853 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:28:58.737496 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m11:28:58.738670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc6100a-620e-4b03-ba32-456daa097442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b1ab19d80>]}
[0m11:28:58.739583 [info ] [Thread-1 (]: 12 of 14 OK created sql table model main.stg_product_nomenclature .............. [[32mOK[0m in 0.04s]
[0m11:28:58.740717 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m11:28:58.741348 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:28:58.742033 [info ] [Thread-1 (]: 13 of 14 START test not_null_client_product_ventes_client_id ................... [RUN]
[0m11:28:58.743030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m11:28:58.743707 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:28:58.752353 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:28:58.754038 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:28:58.757104 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:28:58.758409 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:28:58.759019 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m11:28:58.759438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.760374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.761055 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:28:58.761551 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m11:28:58.762275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.763921 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m11:28:58.764536 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m11:28:58.765297 [info ] [Thread-1 (]: 13 of 14 PASS not_null_client_product_ventes_client_id ......................... [[32mPASS[0m in 0.02s]
[0m11:28:58.766365 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:28:58.767039 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:28:58.767683 [info ] [Thread-1 (]: 14 of 14 START test not_null_product_ventes_date ............................... [RUN]
[0m11:28:58.768447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_date.e36dd44ea0)
[0m11:28:58.769174 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:28:58.779513 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:28:58.781186 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:28:58.784549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:28:58.786196 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:28:58.786908 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: BEGIN
[0m11:28:58.787447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:58.788572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:28:58.789169 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:28:58.789785 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."product_ventes"
where date is null



      
    ) dbt_internal_test
[0m11:28:58.790321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:58.792189 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: ROLLBACK
[0m11:28:58.792957 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: Close
[0m11:28:58.793894 [info ] [Thread-1 (]: 14 of 14 PASS not_null_product_ventes_date ..................................... [[32mPASS[0m in 0.03s]
[0m11:28:58.795881 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:28:58.798230 [debug] [MainThread]: Using sqlite connection "master"
[0m11:28:58.798865 [debug] [MainThread]: On master: BEGIN
[0m11:28:58.799342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:58.801556 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m11:28:58.802132 [debug] [MainThread]: On master: COMMIT
[0m11:28:58.802542 [debug] [MainThread]: Using sqlite connection "master"
[0m11:28:58.803340 [debug] [MainThread]: On master: COMMIT
[0m11:28:58.803915 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:28:58.804523 [debug] [MainThread]: On master: Close
[0m11:28:58.805227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:58.805750 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m11:28:58.806193 [debug] [MainThread]: Connection 'test.dbt_servier.not_null_product_ventes_date.e36dd44ea0' was properly closed.
[0m11:28:58.806874 [info ] [MainThread]: 
[0m11:28:58.807807 [info ] [MainThread]: Finished running 2 seeds, 2 table models, 8 data tests, 2 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m11:28:58.814412 [debug] [MainThread]: Command end result
[0m11:28:58.870925 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m11:28:58.877004 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m11:28:58.896914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m11:28:58.897574 [info ] [MainThread]: 
[0m11:28:58.900964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:58.903293 [info ] [MainThread]: 
[0m11:28:58.903933 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m11:28:58.911816 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.4788961, "process_in_blocks": "40824", "process_kernel_time": 0.449132, "process_mem_max_rss": "112440", "process_out_blocks": "3336", "process_user_time": 3.517306}
[0m11:28:58.912535 [debug] [MainThread]: Command `dbt build` succeeded at 11:28:58.912414 after 2.48 seconds
[0m11:28:58.913166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b22276980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b24ba2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0b221c1bd0>]}
[0m11:28:58.917135 [debug] [MainThread]: Flushing usage events
[0m11:28:59.407645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:04.837347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7a6769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7b506ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7b507e20>]}


============================== 11:31:04.842639 | 1a899ca8-9855-48dd-be3d-1df5fdc1d28e ==============================
[0m11:31:04.842639 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:31:04.844947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/csong/Desktop/test_tech_servier_part_2/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/csong/Desktop/test_tech_servier_part_2/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:31:05.017882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7b505c30>]}
[0m11:31:05.096437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7a5c0f40>]}
[0m11:31:05.097668 [info ] [MainThread]: Registered adapter: sqlite=1.9.0
[0m11:31:05.232240 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:31:05.410937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:05.411581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:05.484768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea79196980>]}
[0m11:31:05.608340 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m11:31:05.611108 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m11:31:05.637667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea791958a0>]}
[0m11:31:05.638329 [info ] [MainThread]: Found 2 seeds, 4 models, 8 data tests, 2 sources, 413 macros
[0m11:31:05.641131 [info ] [MainThread]: 
[0m11:31:05.641747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:05.642221 [info ] [MainThread]: 
[0m11:31:05.642981 [debug] [MainThread]: Acquiring new sqlite connection 'master'
[0m11:31:05.651793 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db'
[0m11:31:05.731243 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m11:31:05.732096 [debug] [ThreadPool]: On list_mydbt.db: BEGIN
[0m11:31:05.732624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:05.733619 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:31:05.734210 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db"
[0m11:31:05.734665 [debug] [ThreadPool]: On list_mydbt.db: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db"} */

        pragma database_list
    
[0m11:31:05.735878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:31:05.737760 [debug] [ThreadPool]: On list_mydbt.db: ROLLBACK
[0m11:31:05.738343 [debug] [ThreadPool]: On list_mydbt.db: Close
[0m11:31:05.741016 [debug] [ThreadPool]: Acquiring new sqlite connection 'list_mydbt.db_main'
[0m11:31:05.753401 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:31:05.754290 [debug] [ThreadPool]: On list_mydbt.db_main: BEGIN
[0m11:31:05.754849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:05.755638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m11:31:05.759065 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:31:05.760052 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

        pragma database_list
    
[0m11:31:05.760663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:05.762141 [debug] [ThreadPool]: Using sqlite connection "list_mydbt.db_main"
[0m11:31:05.762681 [debug] [ThreadPool]: On list_mydbt.db_main: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "connection_name": "list_mydbt.db_main"} */

            SELECT
                'mydbt.db' as database
                ,name
                ,'main' AS schema
                ,type as data_type
            FROM
                main.sqlite_master
            WHERE
                name NOT LIKE 'sqlite_%'
        
[0m11:31:05.763147 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:31:05.764238 [debug] [ThreadPool]: On list_mydbt.db_main: ROLLBACK
[0m11:31:05.764754 [debug] [ThreadPool]: On list_mydbt.db_main: Close
[0m11:31:05.765681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7b5441f0>]}
[0m11:31:05.766228 [debug] [MainThread]: Using sqlite connection "master"
[0m11:31:05.766719 [debug] [MainThread]: On master: BEGIN
[0m11:31:05.767197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:05.768001 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m11:31:05.768447 [debug] [MainThread]: On master: COMMIT
[0m11:31:05.769066 [debug] [MainThread]: Using sqlite connection "master"
[0m11:31:05.769630 [debug] [MainThread]: On master: COMMIT
[0m11:31:05.770181 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:05.770814 [debug] [MainThread]: On master: Close
[0m11:31:05.774166 [debug] [Thread-1 (]: Began running node seed.dbt_servier.product_nomenclature
[0m11:31:05.775192 [info ] [Thread-1 (]: 1 of 14 START seed file main.product_nomenclature .............................. [RUN]
[0m11:31:05.776514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mydbt.db_main, now seed.dbt_servier.product_nomenclature)
[0m11:31:05.777036 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.product_nomenclature
[0m11:31:05.777703 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.product_nomenclature
[0m11:31:05.811050 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:31:05.811701 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: BEGIN
[0m11:31:05.812330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:05.813128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:05.813719 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:31:05.814170 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.product_nomenclature"} */

    create table main."product_nomenclature" ("product_id" INT,"product_type" TEXT,"product_name" TEXT)
  
[0m11:31:05.815778 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:05.838506 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:31:05.839635 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: 
            insert into main.product_nomenclature ("product_id", "product_type", "product_name") values
            (?,?,?),(?,?,?),(?,?,?),(?,?,?)
        ...
[0m11:31:05.841272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:05.855480 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.product_nomenclature"
[0m11:31:05.880330 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m11:31:05.881019 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.product_nomenclature"
[0m11:31:05.881704 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: COMMIT
[0m11:31:05.887782 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:31:05.892324 [debug] [Thread-1 (]: On seed.dbt_servier.product_nomenclature: Close
[0m11:31:05.895135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea78161210>]}
[0m11:31:05.895972 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file main.product_nomenclature .......................... [[32mINSERT 4[0m in 0.12s]
[0m11:31:05.896884 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.product_nomenclature
[0m11:31:05.897512 [debug] [Thread-1 (]: Began running node seed.dbt_servier.transactions
[0m11:31:05.898948 [info ] [Thread-1 (]: 2 of 14 START seed file main.transactions ...................................... [RUN]
[0m11:31:05.900042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.product_nomenclature, now seed.dbt_servier.transactions)
[0m11:31:05.900695 [debug] [Thread-1 (]: Began compiling node seed.dbt_servier.transactions
[0m11:31:05.901337 [debug] [Thread-1 (]: Began executing node seed.dbt_servier.transactions
[0m11:31:05.912810 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:31:05.913357 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: BEGIN
[0m11:31:05.913971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:05.914695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:05.915197 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:31:05.915736 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "seed.dbt_servier.transactions"} */

    create table main."transactions" ("date" TEXT,"order_id" INT,"client_id" INT,"prod_id" INT,"prod_price" REAL,"prod_qty" INT)
  
[0m11:31:05.916459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:05.930762 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:31:05.933167 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: 
            insert into main.transactions ("date", "order_id", "client_id", "prod_id", "prod_price", "prod_qty") values
            (?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?),(?,?,?,?,?,?)
        ...
[0m11:31:05.934488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:05.935550 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_servier.transactions"
[0m11:31:05.938260 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m11:31:05.938910 [debug] [Thread-1 (]: Using sqlite connection "seed.dbt_servier.transactions"
[0m11:31:05.939574 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: COMMIT
[0m11:31:05.942776 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m11:31:05.943946 [debug] [Thread-1 (]: On seed.dbt_servier.transactions: Close
[0m11:31:05.944851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7a9d5f30>]}
[0m11:31:05.945573 [info ] [Thread-1 (]: 2 of 14 OK loaded seed file main.transactions .................................. [[32mINSERT 5[0m in 0.04s]
[0m11:31:05.946571 [debug] [Thread-1 (]: Finished running node seed.dbt_servier.transactions
[0m11:31:05.947156 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:31:05.949051 [info ] [Thread-1 (]: 3 of 14 START test source_not_null_main_product_nomenclature_product_id ........ [RUN]
[0m11:31:05.951390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_servier.transactions, now test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab)
[0m11:31:05.952160 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:31:05.979269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:31:05.980996 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:31:05.999037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:31:06.001376 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:31:06.002116 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: BEGIN
[0m11:31:06.002711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.003644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.004204 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"
[0m11:31:06.004820 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select product_id
from main."product_nomenclature"
where product_id is null



      
    ) dbt_internal_test
[0m11:31:06.005663 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.009291 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: ROLLBACK
[0m11:31:06.009970 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab: Close
[0m11:31:06.010869 [info ] [Thread-1 (]: 3 of 14 PASS source_not_null_main_product_nomenclature_product_id .............. [[32mPASS[0m in 0.06s]
[0m11:31:06.012038 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab
[0m11:31:06.012705 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:31:06.013294 [info ] [Thread-1 (]: 4 of 14 START test source_not_null_main_transactions_client_id ................. [RUN]
[0m11:31:06.014113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_product_nomenclature_product_id.8c6388a2ab, now test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307)
[0m11:31:06.014818 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:31:06.024021 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:31:06.025580 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:31:06.028307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:31:06.029759 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:31:06.030295 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: BEGIN
[0m11:31:06.030909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.031615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.032216 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"
[0m11:31:06.032819 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."transactions"
where client_id is null



      
    ) dbt_internal_test
[0m11:31:06.033569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.037095 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: ROLLBACK
[0m11:31:06.037719 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307: Close
[0m11:31:06.038908 [info ] [Thread-1 (]: 4 of 14 PASS source_not_null_main_transactions_client_id ....................... [[32mPASS[0m in 0.02s]
[0m11:31:06.040001 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307
[0m11:31:06.040686 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:31:06.041350 [info ] [Thread-1 (]: 5 of 14 START test source_not_null_main_transactions_date ...................... [RUN]
[0m11:31:06.042097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_client_id.bbd3d76307, now test.dbt_servier.source_not_null_main_transactions_date.5365394b93)
[0m11:31:06.042660 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:31:06.048502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:31:06.050030 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:31:06.053412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:31:06.055017 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:31:06.055954 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: BEGIN
[0m11:31:06.056605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.057525 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.058076 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"
[0m11:31:06.058701 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_date.5365394b93"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."transactions"
where date is null



      
    ) dbt_internal_test
[0m11:31:06.061547 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.063290 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: ROLLBACK
[0m11:31:06.064345 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_date.5365394b93: Close
[0m11:31:06.065262 [info ] [Thread-1 (]: 5 of 14 PASS source_not_null_main_transactions_date ............................ [[32mPASS[0m in 0.02s]
[0m11:31:06.066179 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_date.5365394b93
[0m11:31:06.066931 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:31:06.067701 [info ] [Thread-1 (]: 6 of 14 START test source_not_null_main_transactions_order_id .................. [RUN]
[0m11:31:06.069249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_date.5365394b93, now test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a)
[0m11:31:06.070530 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:31:06.076417 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:31:06.077988 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:31:06.085194 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:31:06.086730 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:31:06.087271 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: BEGIN
[0m11:31:06.087844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.088480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.089370 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"
[0m11:31:06.089962 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from main."transactions"
where order_id is null



      
    ) dbt_internal_test
[0m11:31:06.090728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.092358 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: ROLLBACK
[0m11:31:06.092989 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a: Close
[0m11:31:06.093763 [info ] [Thread-1 (]: 6 of 14 PASS source_not_null_main_transactions_order_id ........................ [[32mPASS[0m in 0.02s]
[0m11:31:06.094884 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a
[0m11:31:06.095467 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:31:06.096164 [info ] [Thread-1 (]: 7 of 14 START test source_not_null_main_transactions_prod_id ................... [RUN]
[0m11:31:06.098951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_order_id.9b9e13c69a, now test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031)
[0m11:31:06.099984 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:31:06.162574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:31:06.164008 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:31:06.166937 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:31:06.168250 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:31:06.168864 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: BEGIN
[0m11:31:06.169350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.170197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.170796 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"
[0m11:31:06.171302 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select prod_id
from main."transactions"
where prod_id is null



      
    ) dbt_internal_test
[0m11:31:06.172218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.174170 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: ROLLBACK
[0m11:31:06.174747 [debug] [Thread-1 (]: On test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031: Close
[0m11:31:06.175678 [info ] [Thread-1 (]: 7 of 14 PASS source_not_null_main_transactions_prod_id ......................... [[32mPASS[0m in 0.08s]
[0m11:31:06.176745 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031
[0m11:31:06.177331 [debug] [Thread-1 (]: Began running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:31:06.178245 [info ] [Thread-1 (]: 8 of 14 START test source_unique_main_product_nomenclature_product_id .......... [RUN]
[0m11:31:06.179245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_not_null_main_transactions_prod_id.6bf9d50031, now test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717)
[0m11:31:06.179903 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:31:06.187729 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:31:06.189452 [debug] [Thread-1 (]: Began executing node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:31:06.192438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:31:06.193590 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:31:06.194248 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: BEGIN
[0m11:31:06.194875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.195739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.196455 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"
[0m11:31:06.197043 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from main."product_nomenclature"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:31:06.197833 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.200102 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: ROLLBACK
[0m11:31:06.200954 [debug] [Thread-1 (]: On test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717: Close
[0m11:31:06.201929 [info ] [Thread-1 (]: 8 of 14 PASS source_unique_main_product_nomenclature_product_id ................ [[32mPASS[0m in 0.02s]
[0m11:31:06.203135 [debug] [Thread-1 (]: Finished running node test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717
[0m11:31:06.203826 [debug] [Thread-1 (]: Began running node model.dbt_servier.client_product_ventes
[0m11:31:06.204791 [info ] [Thread-1 (]: 9 of 14 START sql view model main.client_product_ventes ........................ [RUN]
[0m11:31:06.206155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.source_unique_main_product_nomenclature_product_id.7a911d1717, now model.dbt_servier.client_product_ventes)
[0m11:31:06.206782 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.client_product_ventes
[0m11:31:06.216627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.client_product_ventes"
[0m11:31:06.218048 [debug] [Thread-1 (]: Began executing node model.dbt_servier.client_product_ventes
[0m11:31:06.231479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.client_product_ventes"
[0m11:31:06.233051 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:31:06.233939 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: BEGIN
[0m11:31:06.236186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.237671 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.238223 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:31:06.238955 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.client_product_ventes"} */

    
    create view main."client_product_ventes" as
    

WITH product_ventes AS (
    SELECT 
        client_id, 
        prod_id, 
        prod_price * prod_qty AS prod_ventes 
    FROM main."transactions" 
    WHERE date BETWEEN "2020-01-01" AND "2020-12-31"
), client_product_ventes AS (
    SELECT 
        pv.client_id, 
        pv.prod_ventes, 
        pn.product_type 
    FROM product_ventes pv
    LEFT JOIN main."product_nomenclature" pn
        ON pv.prod_id = pn.product_id
)

SELECT
    client_id,
    SUM(CASE WHEN product_type = 'MEUBLE' THEN prod_ventes END) AS ventes_meuble,
    SUM(CASE WHEN product_type = 'DECO' THEN prod_ventes END) AS ventes_deco
FROM 
    client_product_ventes
GROUP BY 
    client_id;
[0m11:31:06.240458 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.242221 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m11:31:06.242907 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.client_product_ventes"
[0m11:31:06.243588 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: COMMIT
[0m11:31:06.246351 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.247658 [debug] [Thread-1 (]: On model.dbt_servier.client_product_ventes: Close
[0m11:31:06.248686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea780c10c0>]}
[0m11:31:06.249668 [info ] [Thread-1 (]: 9 of 14 OK created sql view model main.client_product_ventes ................... [[32mOK[0m in 0.04s]
[0m11:31:06.250867 [debug] [Thread-1 (]: Finished running node model.dbt_servier.client_product_ventes
[0m11:31:06.251614 [debug] [Thread-1 (]: Began running node model.dbt_servier.product_ventes
[0m11:31:06.252277 [info ] [Thread-1 (]: 10 of 14 START sql view model main.product_ventes .............................. [RUN]
[0m11:31:06.253285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.client_product_ventes, now model.dbt_servier.product_ventes)
[0m11:31:06.253924 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.product_ventes
[0m11:31:06.261811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.product_ventes"
[0m11:31:06.262884 [debug] [Thread-1 (]: Began executing node model.dbt_servier.product_ventes
[0m11:31:06.267811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.product_ventes"
[0m11:31:06.269291 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:31:06.269988 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: BEGIN
[0m11:31:06.270495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.271523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.272549 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:31:06.273871 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.product_ventes"} */

    
    create view main."product_ventes" as
    

SELECT
    date,
    SUM(prod_price * prod_qty) AS ventes
FROM main."transactions"
WHERE date BETWEEN "2020-01-01" AND "2020-12-31"
GROUP BY date
ORDER BY date;
[0m11:31:06.275093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.277059 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m11:31:06.278665 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.product_ventes"
[0m11:31:06.280568 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: COMMIT
[0m11:31:06.283466 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.284957 [debug] [Thread-1 (]: On model.dbt_servier.product_ventes: Close
[0m11:31:06.285875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7805eb30>]}
[0m11:31:06.286794 [info ] [Thread-1 (]: 10 of 14 OK created sql view model main.product_ventes ......................... [[32mOK[0m in 0.03s]
[0m11:31:06.288135 [debug] [Thread-1 (]: Finished running node model.dbt_servier.product_ventes
[0m11:31:06.288859 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_transactions
[0m11:31:06.290072 [info ] [Thread-1 (]: 11 of 14 START sql table model main.stg_transactions ........................... [RUN]
[0m11:31:06.291047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.product_ventes, now model.dbt_servier.stg_transactions)
[0m11:31:06.291707 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_transactions
[0m11:31:06.295752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_transactions"
[0m11:31:06.296969 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_transactions
[0m11:31:06.313602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_transactions"
[0m11:31:06.315024 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:31:06.315647 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: BEGIN
[0m11:31:06.316111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.316932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.317521 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:31:06.318155 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_transactions"} */

  
    
    
    create  table main."stg_transactions"
    as
        

SELECT
    *
FROM main."transactions"

  
[0m11:31:06.320354 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.322250 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m11:31:06.323248 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_transactions"
[0m11:31:06.324039 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: COMMIT
[0m11:31:06.329548 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:31:06.332603 [debug] [Thread-1 (]: On model.dbt_servier.stg_transactions: Close
[0m11:31:06.334086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7805ff40>]}
[0m11:31:06.335591 [info ] [Thread-1 (]: 11 of 14 OK created sql table model main.stg_transactions ...................... [[32mOK[0m in 0.04s]
[0m11:31:06.337019 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_transactions
[0m11:31:06.337803 [debug] [Thread-1 (]: Began running node model.dbt_servier.stg_product_nomenclature
[0m11:31:06.338806 [info ] [Thread-1 (]: 12 of 14 START sql table model main.stg_product_nomenclature ................... [RUN]
[0m11:31:06.340083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_transactions, now model.dbt_servier.stg_product_nomenclature)
[0m11:31:06.340677 [debug] [Thread-1 (]: Began compiling node model.dbt_servier.stg_product_nomenclature
[0m11:31:06.345354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_servier.stg_product_nomenclature"
[0m11:31:06.347053 [debug] [Thread-1 (]: Began executing node model.dbt_servier.stg_product_nomenclature
[0m11:31:06.353366 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_servier.stg_product_nomenclature"
[0m11:31:06.356668 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:31:06.359986 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: BEGIN
[0m11:31:06.361638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.362952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.363456 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:31:06.364295 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "model.dbt_servier.stg_product_nomenclature"} */

  
    
    
    create  table main."stg_product_nomenclature"
    as
        

SELECT
    *
FROM main."product_nomenclature"

  
[0m11:31:06.365389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.367155 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m11:31:06.367769 [debug] [Thread-1 (]: Using sqlite connection "model.dbt_servier.stg_product_nomenclature"
[0m11:31:06.368191 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: COMMIT
[0m11:31:06.371332 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m11:31:06.372967 [debug] [Thread-1 (]: On model.dbt_servier.stg_product_nomenclature: Close
[0m11:31:06.373918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a899ca8-9855-48dd-be3d-1df5fdc1d28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea78088a30>]}
[0m11:31:06.375288 [info ] [Thread-1 (]: 12 of 14 OK created sql table model main.stg_product_nomenclature .............. [[32mOK[0m in 0.03s]
[0m11:31:06.376957 [debug] [Thread-1 (]: Finished running node model.dbt_servier.stg_product_nomenclature
[0m11:31:06.377703 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:31:06.378372 [info ] [Thread-1 (]: 13 of 14 START test not_null_client_product_ventes_client_id ................... [RUN]
[0m11:31:06.379452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_servier.stg_product_nomenclature, now test.dbt_servier.not_null_client_product_ventes_client_id.633f605896)
[0m11:31:06.379993 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:31:06.386160 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:31:06.387500 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:31:06.391136 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:31:06.392964 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:31:06.395266 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: BEGIN
[0m11:31:06.395851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.396680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.397587 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"
[0m11:31:06.398290 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_client_product_ventes_client_id.633f605896"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select client_id
from main."client_product_ventes"
where client_id is null



      
    ) dbt_internal_test
[0m11:31:06.399231 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.400940 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: ROLLBACK
[0m11:31:06.401561 [debug] [Thread-1 (]: On test.dbt_servier.not_null_client_product_ventes_client_id.633f605896: Close
[0m11:31:06.402470 [info ] [Thread-1 (]: 13 of 14 PASS not_null_client_product_ventes_client_id ......................... [[32mPASS[0m in 0.02s]
[0m11:31:06.403618 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_client_product_ventes_client_id.633f605896
[0m11:31:06.405701 [debug] [Thread-1 (]: Began running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:31:06.406433 [info ] [Thread-1 (]: 14 of 14 START test not_null_product_ventes_date ............................... [RUN]
[0m11:31:06.407706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_servier.not_null_client_product_ventes_client_id.633f605896, now test.dbt_servier.not_null_product_ventes_date.e36dd44ea0)
[0m11:31:06.408544 [debug] [Thread-1 (]: Began compiling node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:31:06.416842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:31:06.418405 [debug] [Thread-1 (]: Began executing node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:31:06.422606 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:31:06.424381 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:31:06.425046 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: BEGIN
[0m11:31:06.425670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.426364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:31:06.427001 [debug] [Thread-1 (]: Using sqlite connection "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"
[0m11:31:06.427608 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_servier", "target_name": "dev", "node_id": "test.dbt_servier.not_null_product_ventes_date.e36dd44ea0"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select date
from main."product_ventes"
where date is null



      
    ) dbt_internal_test
[0m11:31:06.428351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:31:06.430674 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: ROLLBACK
[0m11:31:06.431518 [debug] [Thread-1 (]: On test.dbt_servier.not_null_product_ventes_date.e36dd44ea0: Close
[0m11:31:06.433470 [info ] [Thread-1 (]: 14 of 14 PASS not_null_product_ventes_date ..................................... [[32mPASS[0m in 0.03s]
[0m11:31:06.436229 [debug] [Thread-1 (]: Finished running node test.dbt_servier.not_null_product_ventes_date.e36dd44ea0
[0m11:31:06.439791 [debug] [MainThread]: Using sqlite connection "master"
[0m11:31:06.440360 [debug] [MainThread]: On master: BEGIN
[0m11:31:06.443680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:06.445195 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m11:31:06.445900 [debug] [MainThread]: On master: COMMIT
[0m11:31:06.448271 [debug] [MainThread]: Using sqlite connection "master"
[0m11:31:06.450921 [debug] [MainThread]: On master: COMMIT
[0m11:31:06.451601 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:31:06.452040 [debug] [MainThread]: On master: Close
[0m11:31:06.455220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:06.456842 [debug] [MainThread]: Connection 'list_mydbt.db' was properly closed.
[0m11:31:06.457526 [debug] [MainThread]: Connection 'test.dbt_servier.not_null_product_ventes_date.e36dd44ea0' was properly closed.
[0m11:31:06.458247 [info ] [MainThread]: 
[0m11:31:06.459153 [info ] [MainThread]: Finished running 2 seeds, 2 table models, 8 data tests, 2 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m11:31:06.462473 [debug] [MainThread]: Command end result
[0m11:31:06.506120 [debug] [MainThread]: Wrote artifact WritableManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/manifest.json
[0m11:31:06.508312 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/semantic_manifest.json
[0m11:31:06.518928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/csong/Desktop/test_tech_servier_part_2/dbt/target/run_results.json
[0m11:31:06.519602 [info ] [MainThread]: 
[0m11:31:06.520430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:06.521234 [info ] [MainThread]: 
[0m11:31:06.522032 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m11:31:06.524929 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.7550564, "process_in_blocks": "0", "process_kernel_time": 0.278384, "process_mem_max_rss": "106548", "process_out_blocks": "2288", "process_user_time": 2.926509}
[0m11:31:06.526494 [debug] [MainThread]: Command `dbt build` succeeded at 11:31:06.526367 after 1.76 seconds
[0m11:31:06.527365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7a6769b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7a5b7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea7b5068c0>]}
[0m11:31:06.527971 [debug] [MainThread]: Flushing usage events
[0m11:31:07.005354 [debug] [MainThread]: An error was encountered while trying to flush usage events
